<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>百分百中奖 - 抽奖赢好礼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', '微软雅黑', sans-serif;
            background: url('https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/ee9cdd35-1a1b-4654-841b-fda1f4d56e26/bg.png') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            position: relative;
        }

        /* 键盘调起时的样式处理 */
        @media screen and (max-height: 500px) {
            body {
                min-height: 100vh;
                height: 100vh;
            }
            
            .game-machine {
                min-height: 400px;
            }
            
            .draw-qualification {
                bottom: 7%;
                font-size: 0.8rem;
            }
            
            .controls {
                bottom: 21%;
            }
            
            .user-info-bar {
                top: 6%;
            }
            
            .main-screen {
                top: 18%;
                height: 60%;
            }
            
            .draw-buttons {
                bottom: 2%;
            }
        }
        
        /* 键盘调起时的额外样式 */
        body.keyboard-open {
            height: 100vh;
            overflow: hidden;
        }
        
        body.keyboard-open .game-machine {
            transform: none;
            min-height: 350px;
            margin: 0 15px 15px;
        }
        
        body.keyboard-open .draw-qualification {
            position: relative;
            bottom: auto;
            margin-top: 10px;
            font-size: 0.8rem;
        }
        
        body.keyboard-open .controls {
            position: relative;
            bottom: auto;
            margin-top: 10px;
        }
        
        body.keyboard-open .user-info-bar {
            top: 6%;
        }
        
        /* 键盘调起时的main-screen适配 */
        body.keyboard-open .main-screen {
            position: relative;
            top: auto;
            height: auto;
            min-height: 300px;
            margin: 10px 0;
            padding: 20px 15px;
        }

        body.keyboard-open .draw-cards {
            height: auto;
            min-height: 200px;
            margin-bottom: 15px;
        }

        body.keyboard-open .draw-placeholder {
            padding: 20px 15px;
            min-height: 150px;
        }

        body.keyboard-open .placeholder-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        body.keyboard-open .placeholder-text {
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        body.keyboard-open .placeholder-subtext {
            font-size: 0.9rem;
        }

        body.keyboard-open .draw-buttons {
            position: static;
            margin-top: 15px;
            gap: 15px;
            padding: 0;
        }

        body.keyboard-open .verification-form {
            padding: 10px 15px;
            border-radius: 20px;
        }

        body.keyboard-open .verification-input {
            font-size: 16px;
            padding: 5px 0;
        }

        body.keyboard-open .verification-btn {
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 15px;
        }

        body.keyboard-open .draw-option-btn {
            padding: 10px 20px;
            font-size: 14px;
            min-width: 120px;
        }
        
        body.keyboard-open .draw-buttons {
            position: relative;
            bottom: auto;
            margin-top: 10px;
        }
        
        /* 输入框获得焦点时的样式 */
        .verification-input:focus,
        .address-input:focus,
        .address-textarea:focus {
            transform: none;
            transition: none;
        }
        
        /* 键盘调起时的更稳定布局 */
        body.keyboard-open .game-machine {
            position: relative;
            transform: none;
            min-height: 400px;
            margin: 0 15px 10px;
            padding: 15px 0;
        }
        
        body.keyboard-open .draw-qualification {
            position: static;
            margin: 10px 0;
            padding: 5px 0;
        }
        
        body.keyboard-open .controls {
            position: static;
            margin: 10px 0;
            justify-content: center;
        }
        
        body.keyboard-open .draw-buttons {
            position: static;
            margin: 10px 0;
            justify-content: center;
        }
        
        /* 键盘调起时的draw-placeholder样式 */
        body.keyboard-open .draw-placeholder {
            height: auto;
            min-height: 200px;
            padding: 20px 15px;
            border-radius: 15px;
            font-size: 14px;
        }
        
        body.keyboard-open .placeholder-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        body.keyboard-open .placeholder-text {
            font-size: 1rem;
            margin-bottom: 8px;
        }
        
        body.keyboard-open .placeholder-subtext {
            font-size: 0.8rem;
        }
        
        /* 确保键盘调起时内容不被压缩 */
        body.keyboard-open .main-screen {
            position: relative;
            top: auto;
            height: auto;
            min-height: 200px;
            margin: 10px 0;
        }
        
        /* 键盘调起时保持背景图片完整性 */
        body.keyboard-open .game-machine {
            min-height: 350px;
            max-height: 500px;
        }

        /* 音效控制按钮样式 */
        .sound-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 215, 0, 0.6);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }
        
        .sound-control:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
        }
        
        .sound-control.muted {
            opacity: 0.5;
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* 背景装饰效果 - 已移除，使用新的背景图片 */

        /* 顶部区域 */
        .header {
            text-align: center;
            padding: 20px 15px 30px;
            position: relative;
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: white;
            margin-bottom: 20px;
            opacity: 0.9;
        }



        /* 头部标题图片 */
        .header-title-img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
            max-height: 120px;
            width: auto;
        }

        /* 游戏机主体 */
        .game-machine {
            background: url('https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/e9dae13a-12ec-42a4-b566-93db19c0354b/yxj.png') no-repeat center center;
            background-size: 100% 100%;
            margin: 0 15px 30px;
            border-radius: 25px;
            padding: 20px 0;
            /* box-shadow: 0 10px 30px rgba(0,0,0,0.3); */
            position: relative;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 用户信息栏 - 固定在图片顶部区域 */
        .user-info-bar {
            position: absolute;
            top: 6%;           /* 距离顶部8% */
            left: 17%;         /* 距离左侧15% */
            width: 70%;        /* 宽度占70% */
            padding: 8px 15px;
            justify-content: center;
            display: flex;
            align-items: center;
            z-index: 10;
        }

        /* 切换容器 */
        .scroll-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 用户信息项 */
        .user-info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.5s ease;
            position: relative;
            width: 100%;
            height: 100%;
            justify-content: center;
        }

        .user-info-item.active {
            opacity: 1;
        }

        .user-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #333;
        }

        .user-status {
            color: white;
            font-size: 0.7rem;
            flex: 1;
        }

        /* 主屏幕区域 - 重新设计布局 */
        .main-screen {
            position: absolute;
            top: 13%;           /* 调整顶部位置，给用户信息栏留更多空间 */
            left: 3%;          /* 减少左边距 */
            width: 94%;        /* 增加宽度利用率 */
            height: 60%;       /* 增加高度，提供更多内容空间 */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 0 3vw;
            border-radius: 20px;
          
           
        }

        /* 抽奖卡片区域 - 重新设计 */
        .draw-cards {
            width: 100%;
            height: 70%;       /* 占据主要空间 */
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 2vw;
        }

        /* 抽奖占位符 - 优化样式 */
        .draw-placeholder {
            width: 80%;
            height: 80%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            padding: 4vw;
            border: 2px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .draw-placeholder:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .placeholder-icon {
            font-size: 8vw;
            margin-bottom: 3vw;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .placeholder-text {
            font-size: 4vw;
            font-weight: 600;
            color: #333;
            margin-bottom: 2vw;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .placeholder-subtext {
            font-size: 2.5vw;
            color: #666;
            text-align: center;
            line-height: 1.4;
        }

        /* 奖品网格 */
        .prize-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 3vw;
            margin-bottom: 5vw;
            width: 100%;
            max-width: 90%;
        }

        .prize-item {
            background: #fff5f5;
            border-radius: 4vw;
            padding: 4vw 2vw;
            text-align: center;
            box-shadow: 0 1vw 3vw rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .prize-item:hover {
            transform: translateY(-0.5vw);
            box-shadow: 0 1.5vw 4vw rgba(0,0,0,0.15);
        }

        .prize-icon {
            font-size: 5vw;
            margin-bottom: 2vw;
            display: block;
        }

        .prize-name {
            font-size: 2.5vw;
            color: #333;
            font-weight: 600;
        }

        /* 中央抽奖按钮 */
        .draw-button {
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            border: none;
            border-radius: 5vw;
            padding: 5vw;
            font-size: 3.5vw;
            font-weight: bold;
            color: #ff4757;
            cursor: pointer;
            box-shadow: 0 1.5vw 5vw rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 5vw;
        }

        .draw-button:hover {
            transform: translateY(-0.8vw);
            box-shadow: 0 2vw 6vw rgba(255, 215, 0, 0.6);
        }

        .draw-button:active {
            transform: translateY(-0.3vw);
        }

        /* 抽奖按钮区域 - 重新定位和设计 */
        .draw-buttons {
            position: relative;  /* 改为相对定位 */
            bottom: auto;
            left: auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3vw;
            padding: 2vw 0;
            margin-top: auto;   /* 推到底部 */
        }

        /* 验证区域样式 - 优化 */
        .verification-section {
            width: 100%;
            max-width: 80%;
            display: flex;
            justify-content: center;
            margin-bottom: 2vw;
        }

        .verification-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 2vw;
            width: 100%;
            max-width: 100%;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            padding: 2vw 3vw;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .verification-input {
            flex: 1;
            min-width: 60%;
            border: none;
            background: transparent;
            font-size: 3.5vw;
            color: #333;
            outline: none;
            padding: 1vw 0;
        }

        .verification-input::placeholder {
            color: #999;
        }

        .verification-btn {
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            border: none;
            border-radius: 20px;
            padding: 2vw 4vw;
            font-size: 3vw;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .verification-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        /* 抽奖选项区域 - 优化 */
        .draw-options-section {
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 4vw;
        }

        .draw-option-btn {
            background: linear-gradient(145deg, #ff4757, #ff6b9d);
            border: none;
            border-radius: 15px;
            padding: 3vw 5vw;
            font-size: 3.5vw;
            font-weight: 600;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
            transition: all 0.3s ease;
            min-width: 25vw;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1vw;
        }

        .draw-option-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 71, 87, 0.6);
        }

        .draw-option-btn:active {
            transform: translateY(-1px);
        }

        /* 抽奖区域loading状态样式 */
        .draw-cards.loading {
            position: relative;
            pointer-events: none;
        }
        .draw-cards.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            width: 60px;
            height: 60px;
            margin: auto;
            transform: translateY(-50%);
            border: 5px solid transparent;
            border-top: 5px solid #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            z-index: 1000;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.4);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 抽奖卡片区域loading状态 */
        .draw-cards.loading .draw-placeholder {
            opacity: 0.3;
        }

        /* PC端提示页面 */
        @media screen and (min-width: 768px) {
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                margin: 0;
                padding: 0;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: 'Microsoft YaHei', Arial, sans-serif;
            }
            
            .mobile-container {
                display: none;
            }
            
            .pc-tip {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                text-align: center;
                color: white;
                padding: 50px 40px;
                max-width: 600px;
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
                border-radius: 30px;
                backdrop-filter: blur(20px);
                border: 2px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2);
                position: relative;
                overflow: hidden;
            }
            
            .pc-tip::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
                animation: shine 3s ease-in-out infinite;
                pointer-events: none;
            }
            
            .pc-tip-icon {
                font-size: 5rem;
                margin-bottom: 25px;
                animation: bounce 2s infinite;
                filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            }
            
            .pc-tip-title {
                font-size: 2.5rem;
                font-weight: bold;
                margin-bottom: 20px;
                text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
                background: linear-gradient(135deg, #fff, #f0f0f0);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
            
            .pc-tip-text {
                font-size: 1.2rem;
                line-height: 1.8;
                margin-bottom: 30px;
                opacity: 0.95;
                text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            }
            
            .pc-tip-qrcode {
                margin: 25px 0;
                padding: 20px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 15px;
                border: 1px solid rgba(255, 255, 255, 0.2);
                backdrop-filter: blur(10px);
            }
            
            .pc-tip-qrcode img {
                width: 180px;
                height: 180px;
                border-radius: 10px;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
                border: 3px solid rgba(255, 255, 255, 0.3);
            }
            
            .pc-tip-qrcode-text {
                margin-top: 15px;
                font-size: 1rem;
                color: #e0e0e0;
                font-weight: 500;
            }
            
            .pc-tip-btn {
                padding: 18px 40px;
                background: linear-gradient(135deg, #ff6b6b, #ee5a24);
                color: white;
                border: none;
                border-radius: 15px;
                font-size: 1.2rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 8px 25px rgba(238, 90, 36, 0.4);
                text-decoration: none;
                display: inline-block;
                position: relative;
                overflow: hidden;
            }
            
            .pc-tip-btn::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
                transition: left 0.5s;
            }
            
            .pc-tip-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 30px rgba(238, 90, 36, 0.6);
            }
            
            .pc-tip-btn:hover::before {
                left: 100%;
            }
            
            @keyframes shine {
                0%, 100% { transform: translateX(-100%); }
                50% { transform: translateX(100%); }
            }
            
            @keyframes bounce {
                0%, 20%, 50%, 80%, 100% {
                    transform: translateY(0);
                }
                40% {
                    transform: translateY(-10px);
                }
                60% {
                    transform: translateY(-5px);
                }
            }
        }



            /* PC端抽奖按钮区域 */
            .draw-buttons {
                bottom: 2%;
             
                width: 100%;
                gap: 15px;
                padding: 15px 0;
            }

            /* PC端抽奖资格显示 */
            .draw-qualification {
                bottom: 7%;
             
                width: 60%;
                font-size: 0.8rem;
            }

            /* PC端控制区域 */
            .controls {
                bottom: 21%;
                right: 35%;
                width: 30%;
            }

            .control-btn {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
                border-radius: 50%;
            }

            .rewards-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
                border-radius: 20px;
            }

            .joystick {
                width: 45px;
                height: 45px;
            }

            .joystick::after {
                width: 20px;
                height: 20px;
            }

            /* PC端抽奖卡片区域 */
            .draw-cards {
                gap: 20px;
                padding: 10px;
            }

            /* PC端抽奖占位提示 */
            .draw-placeholder {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                text-align: center;
                color: white;
                padding: 20px 15px;
                border-radius: 15px;
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
                backdrop-filter: blur(10px);
                border: 2px solid rgba(255, 215, 0, 0.3);
                box-shadow: 
                    0 8px 25px rgba(0, 0, 0, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    0 0 15px rgba(255, 215, 0, 0.1);
                
                width: 80%;
                min-height: 200px;
                height: 80%;
                max-height: 400px;
                max-width: 400px;
                
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
            }

            .placeholder-icon {
                font-size: 3rem;
                margin-bottom: 20px;
                animation: float 3s ease-in-out infinite;
                filter: drop-shadow(0 4px 8px rgba(255, 215, 0, 0.3));
                position: relative;
                z-index: 2;
            }

            .placeholder-text {
                font-size: 1.2rem;
                font-weight: bold;
                margin-bottom: 10px;
                color: #ffd700;
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
                position: relative;
                z-index: 2;
                letter-spacing: 1px;
            }

            .placeholder-subtext {
                font-size: 0.9rem;
                opacity: 0.9;
                color: rgba(255, 255, 255, 0.95);
                line-height: 1.4;
                position: relative;
                z-index: 2;
                text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            }

            /* PC端draw-placeholder伪元素样式 */
            .draw-placeholder::before {
                content: '';
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
                animation: shimmer 3s infinite;
                pointer-events: none;
            }

            .draw-placeholder::after {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: radial-gradient(circle at 30% 30%, rgba(255, 215, 0, 0.1), transparent 50%);
                pointer-events: none;
            }

            /* PC端金币不足内容 */
            .insufficient-coins-content {
                padding: 40px 30px;
                border-radius: 15px;
                min-height: 200px;
                max-width: 70%;
            }

            /* PC端音效控制按钮 */
            .sound-control {
                top: 15px;
                right: 15px;
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            /* PC端奖品网格 */
            .prize-grid {
                gap: 15px;
                margin-bottom: 20px;
                max-width: 80%;
            }

            .prize-item {
                border-radius: 15px;
                padding: 20px 15px;
            }

            .prize-icon {
                font-size: 2rem;
                margin-bottom: 10px;
            }

            .prize-name {
                font-size: 0.9rem;
            }

            /* PC端抽奖按钮 */
            .draw-button {
                border-radius: 15px;
                padding: 15px 20px;
                font-size: 1.1rem;
                margin-bottom: 20px;
            }

            /* PC端抽奖选项按钮 */
            .draw-option-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
                border-radius: 20px;
                min-width: 120px;
            }

            /* PC端购物按钮 */
            .shopping-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
                border-radius: 20px;
            }

            /* PC端模态框样式 */
            .modal {
                padding: 20px;
            }

            .modal-content {
                max-width: 600px;
                border-radius: 15px;
            }

            .modal-header {
                padding: 15px 20px;
                border-radius: 15px 15px 0 0;
            }

            .modal-body {
                padding: 20px;
            }

            .modal-footer {
                padding: 15px 20px;
                border-radius: 0 0 15px 15px;
            }

            /* PC端表单样式 */
            .form-group {
                margin-bottom: 15px;
            }

            .form-control {
                padding: 10px 12px;
                border-radius: 8px;
                font-size: 0.9rem;
            }

            .btn {
                padding: 10px 20px;
                border-radius: 8px;
                font-size: 0.9rem;
            }

            /* PC端表格样式 */
            .table {
                font-size: 0.9rem;
            }

            .table th,
            .table td {
                padding: 10px 12px;
            }

            /* PC端分页样式 */
            .pagination {
                gap: 8px;
            }

            .page-link {
                padding: 8px 12px;
                font-size: 0.9rem;
            }



        /* 抽奖资格显示区域 - 固定在按钮下方 */
        .draw-qualification {
            position: absolute;
            bottom: 7%;        /* 距离底部5% */
            left: 20%;         /* 距离左侧20% */
            width: 60%;        /* 宽度占60% */
            text-align: center;
            color: white;
            font-size: 0.9rem;
            flex-shrink: 0;
            z-index: 10;
        }

        /* 控制区域 - 固定在图片右下角 */
        .controls {
            position: absolute;
            bottom: 21%;        /* 距离底部5% */
            right: 35%;        /* 距离右侧10% */
            width: 30%;        /* 宽度占30% */
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
        }

        .control-btn {
            background: #ffd700;
            border: none;
            border-radius: 50%;
            width: 10vw;
            height: 10vw;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3vw;
            cursor: pointer;
            box-shadow: 0 0.8vw 2.5vw rgba(0,0,0,0.2);
        }

        .rewards-btn {
            background: transparent;
            color: transparent;
            border: none;
            border-radius: 5vw;
            padding: 2.5vw 5vw;
            font-size: 2.5vw;
            cursor: pointer;
            box-shadow: none;
        }

        .joystick {
            background: #ffd700;
            border: none;
            border-radius: 50%;
            width: 10vw;
            height: 10vw;
            cursor: pointer;
            box-shadow: 0 0.8vw 2.5vw rgba(0,0,0,0.2);
            position: relative;
        }

        .joystick::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 5vw;
            height: 5vw;
            background: #333;
            border-radius: 50%;
        }

        /* 抽奖卡片区域 */
        .draw-cards {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4vw;
            margin: 0;
            flex-wrap: wrap;
          
            flex: 1;
            padding: 7vw 1vw;
            min-height: 300px;
            height: 90%;
            max-height: 600px;
        }

        /* 抽奖占位提示 - 美化版本 */
        .draw-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 3vw 3vw;
            border-radius: 5vw;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(4vw);
            border: 0.5vw solid rgba(255, 215, 0, 0.3);
            box-shadow: 
                0 2vw 8vw rgba(0, 0, 0, 0.3),
                inset 0 0.3vw 0 rgba(255, 255, 255, 0.2),
                0 0 5vw rgba(255, 215, 0, 0.1);
            
            width: 80%;
            min-height: 200px;
            height: 80%;
            max-height: 400px;
            
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .draw-placeholder::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: shimmer 3s infinite;
            pointer-events: none;
        }

        .draw-placeholder::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 215, 0, 0.1), transparent 50%);
            pointer-events: none;
        }

        .placeholder-icon {
            font-size: 8.5vw;
            margin-bottom: 5vw;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 1vw 2vw rgba(255, 215, 0, 0.3));
            position: relative;
            z-index: 2;
        }

        .placeholder-text {
            font-size: 3.5vw;
            font-weight: bold;
            margin-bottom: 3vw;
            color: #ffd700;
            text-shadow: 0 0.5vw 1vw rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            letter-spacing: 0.3vw;
        }

        .placeholder-subtext {
            font-size: 2.5vw;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.95);
            line-height: 1.4;
            position: relative;
            z-index: 2;
            text-shadow: 0 0.3vw 0.5vw rgba(0, 0, 0, 0.2);
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* 金币不足时显示的内容样式 */
        .insufficient-coins-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 7.5vw 6vw;
            border-radius: 5vw;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(255, 107, 107, 0.05));
            backdrop-filter: blur(4vw);
            border: 0.5vw solid rgba(255, 107, 107, 0.3);
            box-shadow: 
                0 2vw 8vw rgba(0, 0, 0, 0.3),
                inset 0 0.3vw 0 rgba(255, 255, 255, 0.2),
                0 0 5vw rgba(255, 107, 107, 0.1);
            min-height: 55vh; /* 使用视口高度 */
            width: 100%;
            max-width: 80%;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .insufficient-coins-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 107, 107, 0.1), transparent);
            animation: shimmer 3s infinite;
            pointer-events: none;
        }

        .insufficient-coins-content::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 107, 107, 0.1), transparent 50%);
            pointer-events: none;
        }

        .coins-title {
            font-size: 4vw;
            font-weight: bold;
            margin-bottom: 4vw;
            color: #ff6b6b;
            text-shadow: 0 0.5vw 1vw rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            letter-spacing: 0.3vw;
        }

        .coins-text {
            font-size: 3vw;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.95);
            line-height: 1.5;
            position: relative;
            z-index: 2;
            text-shadow: 0 0.3vw 0.5vw rgba(0, 0, 0, 0.2);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-2.5vw) rotate(1.5deg); }
        }
         
         /* 验证表单样式 - 美化版本 */
         .verification-form {
             display: flex;
             flex-direction: row;
             align-items: center;
             gap: 3vw;
             width: 100%;
             max-width: 80%;
             position: relative;
             z-index: 2;
             margin: 0 auto;
         }
         
         .verification-input {
             flex: 1;
             padding: 3vw 4.5vw;
             border: 0.5vw solid rgba(255, 215, 0, 0.4);
             border-radius: 3vw;
             background: rgba(255, 255, 255, 0.9);
             color: #333;
             font-size: 3vw;
             backdrop-filter: blur(4vw);
             outline: none;
             transition: all 0.3s ease;
             box-shadow: 
                 0 1vw 3vw rgba(0, 0, 0, 0.2),
                 inset 0 0.3vw 0 rgba(255, 255, 255, 0.1);
         }
         
         .verification-input::placeholder {
             color: #666;
             font-weight: 500;
         }
         
         .verification-input:focus {
             border-color: #ffd700;
             box-shadow: 
                 0 0 4vw rgba(255, 215, 0, 0.4),
                 0 1vw 3vw rgba(0, 0, 0, 0.2),
                 inset 0 0.3vw 0 rgba(255, 255, 255, 0.1);
             transform: translateY(-0.3vw);
         }
         
         .verification-btn {
             padding: 3vw 6vw;
             background: linear-gradient(145deg, #ffd700, #ffed4e);
             border: none;
             border-radius: 4vw;
             color: #333;
             font-size: 3vw;
             font-weight: bold;
             cursor: pointer;
             transition: all 0.3s ease;
             box-shadow: 
                 0 1.5vw 5vw rgba(255, 215, 0, 0.4),
                 0 0.5vw 2vw rgba(0, 0, 0, 0.2);
             position: relative;
             overflow: hidden;
             white-space: nowrap;
         }
         
         .verification-btn::before {
             content: '';
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
             transition: left 0.5s ease;
         }
         
         .verification-btn:hover {
             transform: translateY(-0.8vw);
             box-shadow: 
                 0 2vw 6vw rgba(255, 215, 0, 0.6),
                 0 1vw 3vw rgba(0, 0, 0, 0.3);
         }
         
         .verification-btn:hover::before {
             left: 100%;
         }
         
                 .verification-btn:active {
            transform: translateY(-0.3vw);
        }

        /* 响应式调整 */
        @media (max-width: 480px) {
            .main-screen {
                top: 13%;
                left: 2%;
                width: 96%;
                height: 60%;
                padding: 0 2vw;
                min-height: 300px;
            }
            
            .draw-cards {
                height: 60%;
                margin-bottom: 1.5vw;
                min-height: 200px;
            }
            
            .draw-placeholder {
                padding: 2.5vw;
                min-height: 150px;
                max-height: 250px;
            }
            
            .verification-form {
                flex-direction: row;
                gap: 2.5vw;
                max-width: 90%;
            }
            
            .verification-input {
                width: 100%;
                min-width: 65%;
                font-size: 2.8vw;
                padding: 2.5vw 4vw;
            }
            
            .verification-btn {
                width: 100%;
                font-size: 2.8vw;
                padding: 2.5vw 5vw;
            }
            
            .draw-buttons {
                gap: 3vw;
                padding: 15px 0;
            }
            
            .draw-options-section {
                gap: 2.5vw;
            }
        }

        @media (max-width: 360px) {
            .main-screen {
                top: 13%;
                left: 1%;
                width: 98%;
                height: 60%;
                padding: 0 1.5vw;
                min-height: 280px;
            }
            
            .draw-cards {
                height: 55%;
                margin-bottom: 1vw;
                min-height: 180px;
            }
            
            .draw-placeholder {
                padding: 2vw;
                min-height: 120px;
                max-height: 200px;
            }
            
            .verification-form {
                max-width: 95%;
                gap: 2vw;
            }
            
            .verification-input {
                min-width: 70%;
                font-size: 2.5vw;
                padding: 2vw 3.5vw;
            }
            
            .verification-btn {
                font-size: 2.5vw;
                padding: 2vw 4.5vw;
            }
            
            .draw-buttons {
                gap: 2.5vw;
                padding: 10px 0;
            }
            
            .draw-options-section {
                gap: 2vw;
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-2.5vw);
            }
            60% {
                transform: translateY(-1.3vw);
            }
        }

        .draw-card {
            width: 18vw;
            height: 25vw;
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            border-radius: 2.5vw;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5vw;
            font-weight: bold;
            color: #ff4757;
            cursor: pointer;
            box-shadow: 0 1vw 4vw rgba(255, 215, 0, 0.4);
            transition: all 0.6s ease;
            transform-style: preserve-3d;
            position: relative;
        }

        /* 金色边框动画效果 */
        @keyframes goldenGlow {
            0% {
                box-shadow: 0 0 5vw rgba(255, 215, 0, 0.8), 0 0 10vw rgba(255, 215, 0, 0.4), 0 0 15vw rgba(255, 215, 0, 0.2);
            }
            50% {
                box-shadow: 0 0 7.5vw rgba(255, 215, 0, 1), 0 0 12.5vw rgba(255, 215, 0, 0.6), 0 0 17.5vw rgba(255, 215, 0, 0.3);
            }
            100% {
                box-shadow: 0 0 5vw rgba(255, 215, 0, 0.8), 0 0 10vw rgba(255, 215, 0, 0.4), 0 0 15vw rgba(255, 215, 0, 0.2);
            }
        }

        @keyframes goldenBorder {
            0% {
                border: 0.8vw solid #ffd700;
            }
            50% {
                border: 0.8vw solid #ffed4e;
            }
            100% {
                border: 0.8vw solid #ffd700;
            }
        }

        @keyframes sparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        .draw-card.golden-prize {
            border: 0.8vw solid #ffd700;
            animation: goldenGlow 2s ease-in-out infinite, goldenBorder 1.5s ease-in-out infinite;
            position: relative;
        }

        .draw-card.golden-prize::before {
            content: '✨';
            position: absolute;
            top: -2.5vw;
            right: -2.5vw;
            font-size: 3vw;
            animation: sparkle 1.5s ease-in-out infinite;
            z-index: 10;
        }

        .draw-card.golden-prize::after {
            content: '🎉';
            position: absolute;
            bottom: -2.5vw;
            left: -2.5vw;
            font-size: 3vw;
            animation: sparkle 1.5s ease-in-out infinite 0.5s;
            z-index: 10;
        }

        .draw-card.flipped {
            transform: rotateY(180deg);
        }

        .draw-card-front,
        .draw-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2.5vw;
        }

        .draw-card-front {
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            color: #ff4757;
        }

        .draw-card-back {
            background: linear-gradient(145deg, #ff4757, #ff6b9d);
            color: white;
            transform: rotateY(180deg);
            font-size: 2vw;
            text-align: center;
            padding: 1.3vw;
        }

        /* 状态显示 - 主屏幕内 */
        .status-display {
            text-align: center;
            color: white;
            font-size: 2.5vw;
            margin-bottom: 4vw;
            width: 100%;
        }

        .decorative-pattern {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2.5vw;
        }

        .pattern-left {
            display: flex;
            gap: 1.3vw;
        }

        .pattern-square {
            width: 2vw;
            height: 2vw;
            background: #ff4757;
            border-radius: 0.5vw;
        }

        .pattern-right {
            display: flex;
            gap: 2vw;
            align-items: center;
        }

        .coin {
            width: 5vw;
            height: 5vw;
            background: #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8vw;
            color: #333;
        }

        .gold-ingot {
            width: 6vw;
            height: 3.5vw;
            background: #ffd700;
            border-radius: 0.8vw;
            margin-left: 1.3vw;
        }

        .rules-text2 {
            color: #666;
            line-height: 1.6;
            font-size: 2.5vw;
            text-align: justify;
            margin: 6vw 0px;
        }

        .shopping-btn {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 6vw;
            padding: 4vw 10vw;
            font-size: 3vw;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 1vw 4vw rgba(255, 71, 87, 0.3);
            transition: all 0.3s ease;
            animation: breathing 2s ease-in-out infinite;
        }

        .shopping-btn:hover {
            transform: translateY(-0.5vw);
            box-shadow: 0 1.5vw 5vw rgba(255, 71, 87, 0.4);
            animation: none;
        }
        
        /* 呼吸效果动画 */
        @keyframes breathing {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 1vw 4vw rgba(255, 71, 87, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 1.5vw 6vw rgba(255, 71, 87, 0.5);
            }
        }

        /* 动画效果 */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .draw-button.animate {
            animation: pulse 0.5s ease-in-out;
        }

        /* 响应式设计 - 统一媒体查询逻辑 */
        /* 小屏幕适配 (480px以下) */
        @media (max-width: 480px) {
            .main-screen {
                top: 13%;
                left: 2%;
                width: 96%;
                height: 60%;
                padding: 0 2vw;
                min-height: 300px;
            }

            .draw-cards {
                height: 60%;
                margin-bottom: 1.5vw;
                min-height: 200px;
            }

            .draw-placeholder {
                padding: 2.5vw;
                min-height: 150px;
                max-height: 250px;
            }

            .placeholder-icon {
                font-size: 6vw;
                margin-bottom: 2.5vw;
            }

            .placeholder-text {
                font-size: 3vw;
                margin-bottom: 1.5vw;
            }

            .placeholder-subtext {
                font-size: 2.2vw;
            }

            .verification-form {
                flex-direction: row;
                gap: 2.5vw;
                max-width: 90%;
            }

            .verification-input {
                width: 100%;
                min-width: 65%;
                font-size: 2.8vw;
                padding: 2.5vw 4vw;
            }

            .verification-btn {
                width: 100%;
                font-size: 2.8vw;
                padding: 2.5vw 5vw;
            }

            .draw-buttons {
                gap: 3vw;
                padding: 15px 0;
            }

            .draw-options-section {
                gap: 2.5vw;
            }
        }
        
        /* 超小屏幕适配 (360px以下) */
        @media (max-width: 360px) {
            .main-screen {
                top: 1%;
                left: 1%;
                width: 98%;
                height: 60%;
                padding: 0 1.5vw;
                min-height: 280px;
            }

            .draw-cards {
                height: 55%;
                margin-bottom: 1vw;
                min-height: 180px;
            }

            .draw-placeholder {
                padding: 2vw;
                min-height: 120px;
                max-height: 200px;
            }

            .placeholder-icon {
                font-size: 5vw;
                margin-bottom: 2vw;
            }

            .placeholder-text {
                font-size: 2.5vw;
                margin-bottom: 1vw;
            }

            .placeholder-subtext {
                font-size: 2vw;
            }

            .verification-form {
                max-width: 95%;
                gap: 2vw;
            }

            .verification-input {
                min-width: 70%;
                font-size: 2.5vw;
                padding: 2vw 3.5vw;
            }

            .verification-btn {
                font-size: 2.5vw;
                padding: 2vw 4.5vw;
            }

            .draw-buttons {
                gap: 2.5vw;
                padding: 10px 0;
            }

            .draw-options-section {
                gap: 2vw;
            }
        }

        /* 弹窗样式 */
        .modal {
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: linear-gradient(145deg, #ff4757, #ff6b9d);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 20px;
        }

        .address-list {
            margin-bottom: 20px;
        }

        .address-item {
            border: 2px solid #f1f1f1;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
            transition: all 0.3s ease;
        }

        .address-item:hover {
            border-color: #ffd700;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .address-item.default {
            border-color: #ffd700;
            background: linear-gradient(145deg, #fff9e6, #fff5cc);
        }

        .address-item.default::before {
            content: '默认';
            position: absolute;
            top: -8px;
            right: 15px;
            background: #ffd700;
            color: #333;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .address-item.selected {
            border-color: #ffd700;
            background: linear-gradient(145deg, #fff9e6, #fff5cc);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .address-item.selected::after {
            content: '已选择';
            position: absolute;
            top: -8px;
            left: 15px;
            background: #28a745;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .address-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .address-phone {
            color: #666;
            margin-bottom: 5px;
        }

        .address-detail {
            color: #333;
            line-height: 1.4;
        }

        .address-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .add-address-btn, .confirm-order-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
         
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-address-btn {
            background: #f1f1f1;
            color: #333;
        }

        .add-address-btn:hover {
            background: #e1e1e1;
        }

        .confirm-order-btn {
            background: linear-gradient(145deg, #ff4757, #ff6b9d);
            color: white;
        }

        .confirm-order-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
        }

        .address-form {
            border: 2px solid #f1f1f1;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            background: #f9f9f9;
        }

        .address-form h4 {
            margin: 0 0 15px 0;
            color: #333;
        }

        .address-input, .address-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .address-input:focus, .address-textarea:focus {
            outline: none;
            border-color: #ffd700;
        }

        .address-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .address-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .address-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .address-checkbox label {
            color: #333;
            font-weight: 500;
        }

        .address-buttons {
            display: flex;
            gap: 10px;
        }

        .save-btn, .cancel-btn {
            flex: 1;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-btn {
            background: linear-gradient(145deg, #2ed573, #7bed9f);
            color: white;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46, 213, 115, 0.4);
        }

        .cancel-btn {
            background: #f1f1f1;
            color: #333;
        }

        .cancel-btn:hover {
            background: #e1e1e1;
        }

        .no-address {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .no-address-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* 订单模块样式 - 现代化设计 */
        .orders-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            margin: 20px 15px;
            border-radius: 25px;
            padding: 15px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
            display: none; /* 默认隐藏，验证后显示 */
            border: 2px solid rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }

        .orders-section::before {
            content: '';
            position: absolute;
            top: 0;
            
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 25px 25px 0 0;
        }

        .orders-title {
            color: #2d3748;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            padding-bottom: 15px;
        }

        .orders-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }

        .orders-container {
            height: 400px;
            overflow-y: auto;
            padding-right: 8px;
            padding-left: 4px;
        }

        /* 自定义滚动条样式 - 现代化设计 */
        .orders-container::-webkit-scrollbar {
            width: 8px;
        }

        .orders-container::-webkit-scrollbar-track {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 4px;
            margin: 4px 0;
        }

        .orders-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            border: 2px solid rgba(248, 250, 252, 0.8);
        }

        .orders-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }

        .loading-orders {
            text-align: center;
            padding: 60px 20px;
            color: #4a5568;
            background: linear-gradient(135deg, rgba(248, 250, 252, 0.8) 0%, rgba(241, 245, 249, 0.8) 100%);
            border-radius: 20px;
            border: 2px dashed rgba(102, 126, 234, 0.3);
            margin: 20px 0;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(102, 126, 234, 0.1);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.2);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 抽奖记录卡片样式 - 专用样式 */
        .lottery-record-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .lottery-record-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 16px 16px 0 0;
        }
        
        .lottery-record-item:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
            border-color: rgba(102, 126, 234, 0.3);
        }
        
        .lottery-record-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            position: relative;
        }
        
        .lottery-record-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .lottery-record-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .lottery-record-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
            border-radius: 12px;
        }
        
        .lottery-record-details h4 {
            color: #2d3748;
            margin-bottom: 6px;
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.3;
        }
        
        .lottery-record-details .detail-item {
            color: #4a5568;
            font-size: 0.9rem;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .lottery-record-details .detail-item strong {
            color: #2d3748;
            font-weight: 600;
        }
        
        .lottery-record-status {
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .lottery-record-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
            border-radius: 16px;
        }
        
        .lottery-record-status.pending {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #744210;
        }
        
        .lottery-record-status.shipped {
            background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
            color: white;
        }
        
        .lottery-record-status.delivered {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .lottery-record-status.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .lottery-record-status.special {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }
        
        .lottery-record-content {
            /* margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.06); */
        }
        
        .lottery-record-content .detail-item {
            color: #4a5568;
            font-size: 0.85rem;
            padding: 8px 0;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            margin-top: 10px;
            background: none;
            border-left: none;
            border-radius: 0;
        }
        
        .lottery-record-content .detail-item:hover {
            background: none;
            transform: none;
        }

        /* 盲盒订单卡片样式 - 专用样式 */
        .blind-box-order-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .blind-box-order-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 16px 16px 0 0;
        }
        
        .blind-box-order-item:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
            border-color: rgba(102, 126, 234, 0.3);
        }
        
        .blind-box-order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            position: relative;
        }
        
        .blind-box-order-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .blind-box-order-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .blind-box-order-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
            border-radius: 12px;
        }
        
        .blind-box-order-details h4 {
            color: #2d3748;
            margin-bottom: 6px;
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.3;
        }
        
        .blind-box-order-details .detail-item {
            color: #4a5568;
            font-size: 0.9rem;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .blind-box-order-details .detail-item strong {
            color: #2d3748;
            font-weight: 600;
        }
        
        .blind-box-order-status {
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .blind-box-order-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
            border-radius: 16px;
        }
        
        .blind-box-order-status.pending {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #744210;
        }
        
        .blind-box-order-status.shipped {
            background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
            color: white;
        }
        
        .blind-box-order-status.delivered {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .blind-box-order-status.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .blind-box-order-status.special {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }
        
        .blind-box-order-content {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        
        .blind-box-order-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }
        
        .blind-box-order-details-grid .detail-item {
            color: #4a5568;
            font-size: 0.85rem;
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 8px;
            border-left: 3px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .blind-box-order-details-grid .detail-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateX(4px);
        }
        
        .blind-box-order-details-grid .detail-item strong {
            color: #2d3748;
            font-weight: 600;
            margin-right: 8px;
        }

        /* 弹窗中的订单容器样式 - 现代化设计 */
        #modalOrdersContainer {
            height: 400px;
            overflow-y: auto;
            padding-right: 8px;
            padding-left: 4px;
        }

        #modalOrdersContainer::-webkit-scrollbar {
            width: 8px;
        }

        #modalOrdersContainer::-webkit-scrollbar-track {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 4px;
            margin: 4px 0;
        }

        #modalOrdersContainer::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            border: 2px solid rgba(248, 250, 252, 0.8);
        }

        #modalOrdersContainer::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }

        .no-orders {
            text-align: center;
            padding: 60px 20px;
            color: #4a5568;
            background: linear-gradient(135deg, rgba(248, 250, 252, 0.8) 0%, rgba(241, 245, 249, 0.8) 100%);
            border-radius: 20px;
            border: 2px dashed rgba(102, 126, 234, 0.3);
            margin: 20px 0;
        }

        .no-orders-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.7;
            animation: float 3s ease-in-out infinite;
        }



        .order-info {
            margin-bottom: 10px;
        }

        .order-item-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .order-price {
            color: #ff4757;
            font-weight: bold;
        }

        .order-time {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 8px;
        }

        .order-contact {
            background: #e9ecef;
            padding: 8px;
            border-radius: 6px;
            font-size: 0.85rem;
        }

        .order-contact-name {
            font-weight: bold;
            color: #333;
        }

        .order-contact-phone {
            color: #666;
            margin-left: 10px;
        }

        .order-contact-address {
            color: #666;
            margin-top: 5px;
            word-break: break-all;
        }
        
        /* 通用详情项样式 - 保持原有样式 */
        .detail-item {
            color: #4a5568;
            font-size: 0.85rem;
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 8px;
            border-left: 3px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .detail-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateX(4px);
        }
        
        .detail-item strong {
            color: #2d3748;
            font-weight: 600;
            margin-right: 8px;
        }
        
        .virtual-item {
            border-left: 4px solid #28a745;
            position: relative;
        }
        
        .virtual-item::after {
            content: '🎁';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.2rem;
            opacity: 0.7;
        }

        /* 盲盒商品模块样式 - 现代化设计 */
        .blind-box-products-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            margin: 20px 15px;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }

        .blind-box-products-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 25px 25px 0 0;
        }

        .blind-box-products-title {
            color: #2d3748;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            padding-bottom: 15px;
        }

        .blind-box-products-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }

        .blind-box-products-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .blind-box-product-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 5px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .blind-box-product-item::before {
            /* content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700 0%, #ffed4e 100%);
            border-radius: 20px 20px 0 0; */
        }

        .blind-box-product-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 100%);
            pointer-events: none;
        }

        .blind-box-product-item:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
            border-color: rgba(255, 215, 0, 0.5);
        }

        .blind-box-product-image {
            width: 100%;
            /* height: 140px; */
            margin: 0 auto 15px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .blind-box-product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 14px;
            transition: all 0.3s ease;
        }

        .blind-box-product-item:hover .blind-box-product-image img {
            transform: scale(1.05);
        }

        .blind-box-product-description {
            color: white;
            font-size: 0.95rem;
            font-weight: 600;
            line-height: 1.4;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* 控制区域 - 固定在图片右下角 */
        .controls {
            position: absolute;
            bottom: 21%;        /* 距离底部5% */
            right: 35%;        /* 距离右侧10% */
            width: 30%;        /* 宽度占30% */
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
        }

        .draw-option-btn {
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            border: none;
            border-radius: 15px;
            padding: 15px 25px;
            font-size: 3vw;
            font-weight: bold;
            color: #ff4757;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .draw-option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        .draw-option-btn:active {
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <!-- PC端提示页面 -->
    <div class="pc-tip" id="pcTip" style="display: none;">
        <div class="pc-tip-icon">📱</div>
        <div class="pc-tip-title">请使用手机访问</div>
        <div class="pc-tip-text">
            为了获得最佳体验，请使用手机浏览器访问此页面。<br>
            本抽奖活动专为移动端设计，PC端暂不支持。
        </div>
        <div class="pc-tip-qrcode">
            <img src="https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/3dfbcad5-ead7-4116-af85-a389ab109bb1/cj.png" alt="扫码访问">
            <div class="pc-tip-qrcode-text">扫描二维码，用手机访问</div>
        </div>
        
    </div>

    <!-- 移动端内容 -->
    <div class="mobile-container" id="mobileContainer">
        <!-- 音效控制按钮 -->
        <div class="sound-control" id="soundControl" onclick="toggleSound()">
            🔊
        </div>

        <!-- 顶部区域 -->
        <div class="header">
            <img src="https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/77ec949d-7b3f-4c73-94ed-cc9cc19b02c9/title.png" alt="百分百中奖" class="header-title-img">
        </div>

    <!-- 游戏机主体 -->
    <div class="game-machine">
                 <!-- 用户信息栏 - 顶部狭长区域 -->
         <div class="user-info-bar">
             <div class="scroll-container" id="userInfoContainer">
                 <!-- 用户信息将通过JavaScript动态生成 -->
             </div>
         </div>

                          <!-- 主屏幕区域 - 抽奖内容 -->
         <div class="main-screen">
                                                       <!-- 抽奖卡片区域 -->
               <div class="draw-cards" id="drawCards">
                                  <!-- 默认提示文案 -->
                <div class="draw-placeholder" id="drawPlaceholder">
                    
                    
                </div>
                    
                   <!-- 卡片将通过JavaScript动态生成 -->
               </div>

               <!-- 抽奖按钮区域 - 固定在图片底部区域 -->
                        <div class="draw-buttons" id="drawButtons">
                            <!-- 验证区域 -->
                            <div class="verification-section">
                                <div class="verification-form" id="verificationForm">
                                    <input type="text" id="verificationCode" placeholder="请输入验证码" class="verification-input" maxlength="8" onkeypress="handleKeyPress(event)" oninput="limitInput(this)">
                                    <button onclick="handleVerification()" class="verification-btn">验证</button>
                                </div>
                            </div>
                            
                            <!-- 抽奖按钮组 -->
                            <div class="draw-options-section">
                                <button class="draw-option-btn" onclick="startDraw(1)">20<svg t="1754277660881" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5506" width="16" height="16" style="vertical-align: middle; margin: 0 2px;"><path d="M512 528m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#F2814E" p-id="5507"></path><path d="M512 496m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#FFDC88" p-id="5508"></path><path d="M512 496m-282 0a282 282 0 1 0 564 0 282 282 0 1 0-564 0Z" fill="#FFBC54" p-id="5509"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5510"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5511"></path><path d="M257.4 801.828c14.168-7.124 31.124-14.42 36.6-35.828 20.132-78.676 424-508 424-508s0.372-52.644 29.852-82.536C846.172 247.96 910 364.584 910 496c0 219.664-178.336 398-398 398-96.8 0-185.572-34.632-254.6-92.172z" fill="#F47A38" fill-opacity=".5" p-id="5512"></path><path d="M716.296 301.688a30.104 30.104 0 0 1-0.228-41.464c1.24-1.488 1.932-2.224 1.932-2.224v-0.144a0.188 0.188 0 0 1 0.044-0.24 0.188 0.188 0 0 1 0.244 0c66.784 57.816 109.044 143.204 109.044 238.384 0 174.036-141.296 315.332-315.332 315.332-72.76 0-139.8-24.696-193.18-66.156a14.96 14.96 0 0 1-3.216-19.928l-0.036-0.02a18.172 18.172 0 0 1 26.248-4.452C389.112 756.692 448.088 778 512 778c155.64 0 282-126.36 282-282 0-75.284-29.564-143.716-77.704-194.312z" fill="#FFBA58" p-id="5513"></path><path d="M496.016 347.784a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.668 19.668 0 0 1 9.88 30.404l-53.308 72.396a19.668 19.668 0 0 0-3.828 11.788l0.572 89.896a19.668 19.668 0 0 1-25.864 18.792l-85.324-28.324a19.656 19.656 0 0 0-12.392 0l-85.324 28.324a19.664 19.664 0 0 1-25.864-18.792l0.572-89.896a19.668 19.668 0 0 0-3.828-11.788l-53.308-72.396a19.668 19.668 0 0 1 9.88-30.404l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FA7F4B" p-id="5514"></path><path d="M496.016 327.004a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.68 19.68 0 0 1 9.88 30.408l-53.308 72.392a19.668 19.668 0 0 0-3.828 11.788l0.572 89.9a19.664 19.664 0 0 1-25.864 18.792l-85.324-28.328a19.656 19.656 0 0 0-12.392 0l-85.324 28.328a19.668 19.668 0 0 1-25.864-18.792l0.572-89.9a19.668 19.668 0 0 0-3.828-11.788L338.052 465a19.68 19.68 0 0 1 9.88-30.408l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FFBC54" p-id="5515"></path><path d="M338.444 461.512a25.548 25.548 0 0 1 17.3-29.404l76.008-24.16a25.564 25.564 0 0 0 13.02-9.46l46.468-64.82a25.54 25.54 0 0 1 41.52 0l46.468 64.82a25.564 25.564 0 0 0 13.02 9.46l76.008 24.16a25.548 25.548 0 0 1 16.16 33.36c-49.228 10.14-104.98 15.864-164.024 15.864-66.332 0-128.508-7.224-181.948-19.82z" fill="#FFEA8D" p-id="5516"></path><path d="M787.368 557.016a17.312 17.312 0 0 1 21.992-12.948c0.376 0.124 0.752 0.236 1.124 0.356a14.752 14.752 0 0 1 10.016 17.036c-18.42 87.196-72.936 161.14-147.148 205.464a15.988 15.988 0 0 1-21.116-4.48l0.016-0.016a17.24 17.24 0 0 1 5.224-24.844c65.064-39.296 113.004-104.128 129.892-180.568z" fill="#FFED8C" p-id="5517"></path></svg>/1次</button>
                                <button class="draw-option-btn" onclick="startDraw(5)">90<svg t="1754277660881" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5506" width="16" height="16" style="vertical-align: middle; margin: 0 2px;"><path d="M512 528m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#F2814E" p-id="5507"></path><path d="M512 496m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#FFDC88" p-id="5508"></path><path d="M512 496m-282 0a282 282 0 1 0 564 0 282 282 0 1 0-564 0Z" fill="#FFBC54" p-id="5509"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5510"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5511"></path><path d="M257.4 801.828c14.168-7.124 31.124-14.42 36.6-35.828 20.132-78.676 424-508 424-508s0.372-52.644 29.852-82.536C846.172 247.96 910 364.584 910 496c0 219.664-178.336 398-398 398-96.8 0-185.572-34.632-254.6-92.172z" fill="#F47A38" fill-opacity=".5" p-id="5512"></path><path d="M716.296 301.688a30.104 30.104 0 0 1-0.228-41.464c1.24-1.488 1.932-2.224 1.932-2.224v-0.144a0.188 0.188 0 0 1 0.044-0.24 0.188 0.188 0 0 1 0.244 0c66.784 57.816 109.044 143.204 109.044 238.384 0 174.036-141.296 315.332-315.332 315.332-72.76 0-139.8-24.696-193.18-66.156a14.96 14.96 0 0 1-3.216-19.928l-0.036-0.02a18.172 18.172 0 0 1 26.248-4.452C389.112 756.692 448.088 778 512 778c155.64 0 282-126.36 282-282 0-75.284-29.564-143.716-77.704-194.312z" fill="#FFBA58" p-id="5513"></path><path d="M496.016 347.784a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.668 19.668 0 0 1 9.88 30.404l-53.308 72.396a19.668 19.668 0 0 0-3.828 11.788l0.572 89.896a19.668 19.668 0 0 1-25.864 18.792l-85.324-28.324a19.656 19.656 0 0 0-12.392 0l-85.324 28.324a19.664 19.664 0 0 1-25.864-18.792l0.572-89.896a19.668 19.668 0 0 0-3.828-11.788l-53.308-72.396a19.668 19.668 0 0 1 9.88-30.404l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FA7F4B" p-id="5514"></path><path d="M496.016 327.004a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.68 19.68 0 0 1 9.88 30.408l-53.308 72.392a19.668 19.668 0 0 0-3.828 11.788l0.572 89.9a19.664 19.664 0 0 1-25.864 18.792l-85.324-28.328a19.656 19.656 0 0 0-12.392 0l-85.324 28.328a19.668 19.668 0 0 1-25.864-18.792l0.572-89.9a19.668 19.668 0 0 0-3.828-11.788L338.052 465a19.68 19.68 0 0 1 9.88-30.408l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FFBC54" p-id="5515"></path><path d="M338.444 461.512a25.548 25.548 0 0 1 17.3-29.404l76.008-24.16a25.564 25.564 0 0 0 13.02-9.46l46.468-64.82a25.54 25.54 0 0 1 41.52 0l46.468 64.82a25.564 25.564 0 0 0 13.02 9.46l76.008 24.16a25.548 25.548 0 0 1 16.16 33.36c-49.228 10.14-104.98 15.864-164.024 15.864-66.332 0-128.508-7.224-181.948-19.82z" fill="#FFEA8D" p-id="5516"></path><path d="M787.368 557.016a17.312 17.312 0 0 1 21.992-12.948c0.376 0.124 0.752 0.236 1.124 0.356a14.752 14.752 0 0 1 10.016 17.036c-18.42 87.196-72.936 161.14-147.148 205.464a15.988 15.988 0 0 1-21.116-4.48l0.016-0.016a17.24 17.24 0 0 1 5.224-24.844c65.064-39.296 113.004-104.128 129.892-180.568z" fill="#FFED8C" p-id="5517"></path></svg>/5次</button>
                            </div>
                        </div>
         </div>
         
         
         
                   <div class="draw-qualification" id="drawQualification">
             您当前拥有 0 金币
          </div>
  
          
        

        <!-- 控制区域 - 底部固定 -->
        <div class="controls">
           
            <button class="rewards-btn">我的奖励 ></button>
    
        </div>
    </div>



    <!-- 盲盒商品模块 -->
    <div class="blind-box-products-section">
        <h3 class="blind-box-products-title">盲盒商品</h3>
        <div class="blind-box-products-grid" id="blindBoxProductsGrid">
            <!-- 盲盒商品将通过JavaScript动态生成 -->
        </div>
        
        <p class="rules-text2">
            兑换成功后，在公众号回复订单号获取物流信息
        </p>
                 <button class="shopping-btn">兑换盲盒/2000<svg t="1754277660881" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5506" width="16" height="16" style="vertical-align: middle; margin: 0 2px;"><path d="M512 528m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#F2814E" p-id="5507"></path><path d="M512 496m-398 0a398 398 0 1 0 796 0 398 398 0 1 0-796 0Z" fill="#FFDC88" p-id="5508"></path><path d="M512 496m-282 0a282 282 0 1 0 564 0 282 282 0 1 0-564 0Z" fill="#FFBC54" p-id="5509"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5510"></path><path d="M512 180.668c174.036 0 315.332 141.296 315.332 315.332S686.036 811.332 512 811.332 196.668 670.036 196.668 496 337.964 180.668 512 180.668z m0 33.332c-155.64 0-282 126.36-282 282s126.36 282 282 282 282-126.36 282-282-126.36-282-282-282z" fill="#FA7B4D" p-id="5511"></path><path d="M257.4 801.828c14.168-7.124 31.124-14.42 36.6-35.828 20.132-78.676 424-508 424-508s0.372-52.644 29.852-82.536C846.172 247.96 910 364.584 910 496c0 219.664-178.336 398-398 398-96.8 0-185.572-34.632-254.6-92.172z" fill="#F47A38" fill-opacity=".5" p-id="5512"></path><path d="M716.296 301.688a30.104 30.104 0 0 1-0.228-41.464c1.24-1.488 1.932-2.224 1.932-2.224v-0.144a0.188 0.188 0 0 1 0.044-0.24 0.188 0.188 0 0 1 0.244 0c66.784 57.816 109.044 143.204 109.044 238.384 0 174.036-141.296 315.332-315.332 315.332-72.76 0-139.8-24.696-193.18-66.156a14.96 14.96 0 0 1-3.216-19.928l-0.036-0.02a18.172 18.172 0 0 1 26.248-4.452C389.112 756.692 448.088 778 512 778c155.64 0 282-126.36 282-282 0-75.284-29.564-143.716-77.704-194.312z" fill="#FFBA58" p-id="5513"></path><path d="M496.016 347.784a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.668 19.668 0 0 1 9.88 30.404l-53.308 72.396a19.668 19.668 0 0 0-3.828 11.788l0.572 89.896a19.668 19.668 0 0 1-25.864 18.792l-85.324-28.324a19.656 19.656 0 0 0-12.392 0l-85.324 28.324a19.664 19.664 0 0 1-25.864-18.792l0.572-89.896a19.668 19.668 0 0 0-3.828-11.788l-53.308-72.396a19.668 19.668 0 0 1 9.88-30.404l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FA7F4B" p-id="5514"></path><path d="M496.016 327.004a19.664 19.664 0 0 1 31.968 0l52.38 73.068a19.668 19.668 0 0 0 10.028 7.284l85.676 27.236a19.68 19.68 0 0 1 9.88 30.408l-53.308 72.392a19.668 19.668 0 0 0-3.828 11.788l0.572 89.9a19.664 19.664 0 0 1-25.864 18.792l-85.324-28.328a19.656 19.656 0 0 0-12.392 0l-85.324 28.328a19.668 19.668 0 0 1-25.864-18.792l0.572-89.9a19.668 19.668 0 0 0-3.828-11.788L338.052 465a19.68 19.68 0 0 1 9.88-30.408l85.676-27.236a19.668 19.668 0 0 0 10.028-7.284l52.38-73.068z" fill="#FFBC54" p-id="5515"></path><path d="M338.444 461.512a25.548 25.548 0 0 1 17.3-29.404l76.008-24.16a25.564 25.564 0 0 0 13.02-9.46l46.468-64.82a25.54 25.54 0 0 1 41.52 0l46.468 64.82a25.564 25.564 0 0 0 13.02 9.46l76.008 24.16a25.548 25.548 0 0 1 16.16 33.36c-49.228 10.14-104.98 15.864-164.024 15.864-66.332 0-128.508-7.224-181.948-19.82z" fill="#FFEA8D" p-id="5516"></path><path d="M787.368 557.016a17.312 17.312 0 0 1 21.992-12.948c0.376 0.124 0.752 0.236 1.124 0.356a14.752 14.752 0 0 1 10.016 17.036c-18.42 87.196-72.936 161.14-147.148 205.464a15.988 15.988 0 0 1-21.116-4.48l0.016-0.016a17.24 17.24 0 0 1 5.224-24.844c65.064-39.296 113.004-104.128 129.892-180.568z" fill="#FFED8C" p-id="5517"></path></svg></button>
    </div>

    <!-- 订单模块 -->
    <div class="orders-section">
        <h3 class="orders-title">我的盲盒订单</h3>
        <div class="orders-container" id="ordersContainer">
            <div class="loading-orders" id="loadingOrders">
                <div class="loading-spinner"></div>
                <div>正在加载订单...</div>
            </div>
        </div>
    </div>

    

    <!-- 地址管理弹窗 -->
    <div id="addressModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>收货地址管理</h3>
                <span class="close" onclick="closeAddressModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="addressList" class="address-list">
                    <!-- 地址列表将通过JavaScript动态生成 -->
                </div>
                <div class="address-form" id="addressForm" style="display: none;">
                    <h4>添加/编辑地址</h4>
                    <input type="text" id="addressName" placeholder="收货人姓名" class="address-input">
                    <input type="text" id="addressPhone" placeholder="联系电话" class="address-input">
                    <textarea id="addressDetail" placeholder="详细地址" class="address-textarea"></textarea>
                    <div class="address-checkbox">
                        <input type="checkbox" id="addressDefault">
                        <label for="addressDefault">设为默认地址</label>
                    </div>
                    <div class="address-buttons">
                        <button onclick="saveAddress()" class="save-btn">保存地址</button>
                        <button onclick="cancelAddress()" class="cancel-btn">取消</button>
                    </div>
                </div>
                <div class="address-actions">
                    <button onclick="showAddressForm()" class="add-address-btn">+ 新增地址</button>
                    <button onclick="confirmBlindBoxOrder()" class="confirm-order-btn">确认兑换盲盒</button>
                </div>
            </div>
        </div>
    </div>

               <!-- 抽奖记录弹窗 -->
           <div id="ordersModal" class="modal" style="display: none;">
               <div class="modal-content">
                   <div class="modal-header">
                       <h3>抽奖记录</h3>
                       <span class="close" onclick="closeOrdersModal()">&times;</span>
                   </div>
                   <div class="modal-body">
                       <div class="orders-container" id="modalOrdersContainer">
                           <div class="loading-orders" id="modalLoadingOrders">
                               <div class="loading-spinner"></div>
                               <div>正在加载记录...</div>
                           </div>
                       </div>
                   </div>
               </div>
           </div>

                   <script>
          // API基础URL
          const API_BASE_URL = 'https://www.fuyetask.top:83/public/api/lottery';
        //    const API_BASE_URL = 'http://127.0.0.1:8000/public/api/lottery';
          
                     // 用户状态
           let currentUser = null;
           let isVerified = false;
           
           // 音效控制
           let soundEnabled = true;
           
           // 音效对象
           const sounds = {
               draw: null,
               win: null,
               lose: null,
               flip: null
           };
           
           // 初始化音效
           function initSounds() {
               // 创建抽奖音效（使用Web Audio API生成）
               const audioContext = new (window.AudioContext || window.webkitAudioContext)();
               
               // 抽奖音效 - 令人兴奋的上升音调
               function createDrawSound() {
                   const oscillator = audioContext.createOscillator();
                   const gainNode = audioContext.createGain();
                   
                   oscillator.connect(gainNode);
                   gainNode.connect(audioContext.destination);
                   
                   oscillator.type = 'sine';
                   oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                   oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.5);
                   
                   gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                   gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.1);
                   gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                   
                   oscillator.start(audioContext.currentTime);
                   oscillator.stop(audioContext.currentTime + 0.5);
               }
               
               // 中奖音效 - 欢快的胜利音调
               function createWinSound() {
                   const oscillator = audioContext.createOscillator();
                   const gainNode = audioContext.createGain();
                   
                   oscillator.connect(gainNode);
                   gainNode.connect(audioContext.destination);
                   
                   oscillator.type = 'triangle';
                   oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // C5
                   oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1); // E5
                   oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2); // G5
                   oscillator.frequency.setValueAtTime(1047, audioContext.currentTime + 0.3); // C6
                   
                   gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                   gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + 0.05);
                   gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                   
                   oscillator.start(audioContext.currentTime);
                   oscillator.stop(audioContext.currentTime + 0.4);
               }
               
               // 卡片翻转音效
               function createFlipSound() {
                   const oscillator = audioContext.createOscillator();
                   const gainNode = audioContext.createGain();
                   
                   oscillator.connect(gainNode);
                   gainNode.connect(audioContext.destination);
                   
                   oscillator.type = 'square';
                   oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                   oscillator.frequency.setValueAtTime(400, audioContext.currentTime + 0.1);
                   
                   gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                   gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.05);
                   gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                   
                   oscillator.start(audioContext.currentTime);
                   oscillator.stop(audioContext.currentTime + 0.2);
               }
               
               sounds.draw = createDrawSound;
               sounds.win = createWinSound;
               sounds.flip = createFlipSound;
           }
           
           // 播放音效
           function playSound(soundType) {
               if (!soundEnabled) return;
               
               try {
                   if (sounds[soundType]) {
                       sounds[soundType]();
                   }
               } catch (error) {
                   console.log('音效播放失败:', error);
               }
           }
           
           // 切换音效开关
           function toggleSound() {
               soundEnabled = !soundEnabled;
               const soundControl = document.getElementById('soundControl');
               
               if (soundEnabled) {
                   soundControl.textContent = '🔊';
                   soundControl.classList.remove('muted');
               } else {
                   soundControl.textContent = '🔇';
                   soundControl.classList.add('muted');
               }
               
               // 保存音效设置到本地存储
               localStorage.setItem('soundEnabled', soundEnabled);
           }
           
           // 抽奖记录分页相关变量
           let currentPage = 1;
           let hasMoreRecords = true;
           let isLoadingRecords = false;
           
           // 从本地存储恢复验证状态
           async function loadVerificationState() {
               const savedUser = localStorage.getItem('lottery_user');
               const savedVerified = localStorage.getItem('lottery_verified');
               
               if (savedUser && savedVerified === 'true') {
                   try {
                       currentUser = JSON.parse(savedUser);
                       isVerified = true;
                       console.log('从本地存储恢复验证状态');
                       
                       // 调用API获取用户最新信息
                       await refreshUserInfo();
                       
                       // 显示订单模块
                       const ordersSection = document.querySelector('.orders-section');
                       if (ordersSection) {
                           ordersSection.style.display = 'block';
                       }
                   } catch (error) {
                       console.error('解析本地存储数据失败:', error);
                       clearVerificationState();
                   }
               }
           }
           
           // 刷新用户信息
           async function refreshUserInfo() {
               if (!currentUser || !currentUser.user_id) {
                   console.log('用户信息不完整，跳过刷新');
                   return;
               }
               
               try {
                   console.log('正在获取用户最新信息...');
                   const response = await fetch(`${API_BASE_URL}/my-coins/?user_id=${currentUser.user_id}`, {
                       method: 'GET',
                       headers: {
                           'Content-Type': 'application/json',
                       }
                   });

                   const data = await response.json();
                   
                   if (response.ok && data.code === 200) {
                       // 更新用户信息
                       currentUser = {
                           user_id: data.data.user_id,
                           name: data.data.name,
                           coins: data.data.coins,
                           kills: data.data.kills
                       };
                       
                       console.log('用户信息已更新:', currentUser);
                       
                       // 更新页面显示
                       updateDrawQualification();
                       updateDrawCardsDisplay();
                       
                       // 保存更新后的状态
                       saveVerificationState();
                   } else {
                       console.error('获取用户信息失败:', data);
                       // 如果获取失败，清除验证状态
                       clearVerificationState();
                   }
               } catch (error) {
                   console.error('刷新用户信息API错误:', error);
                   // 如果网络错误，保持当前状态不变
               }
           }
           
           // 保存验证状态到本地存储
           function saveVerificationState() {
               if (currentUser && isVerified) {
                   localStorage.setItem('lottery_user', JSON.stringify(currentUser));
                   localStorage.setItem('lottery_verified', 'true');
                   console.log('验证状态已保存到本地存储');
               }
           }
           
           // 清除验证状态
           function clearVerificationState() {
               localStorage.removeItem('lottery_user');
               localStorage.removeItem('lottery_verified');
               currentUser = null;
               isVerified = false;
               console.log('验证状态已清除');
           }
          
          // 奖品列表（保留作为备用）
          const prizes = [
              '💻 苹果笔记本',
              '📱 iPhone 7 MAX',
              '⌚ Apple Watch',
              '🧧 500元红包',
              '🧧 200元红包',
              '🧧 100元红包',
              '🧧 50元红包',
              '🧧 10元红包',
              '🎁 谢谢参与'
          ];

                                       // 抽奖功能
          // 防重复点击时间戳
          let lastDrawClickTime = 0;
          
          async function startDraw(times) {
              // 防重复点击检查 - 1秒内只能点击一次
              const currentTime = Date.now();
              if (currentTime - lastDrawClickTime < 1000) {
                  showToast('你的手速太快了吧', 'warning');
                  return;
              }
              
              // 记录点击时间
              lastDrawClickTime = currentTime;
              
              // 获取draw-cards区域并添加loading状态
              const drawCards = document.getElementById('drawCards');
              drawCards.classList.add('loading');
              
              // 检查用户是否已验证
          if (!isVerified || !currentUser) {
              showToast('请先验证身份', 'error');
              return;
          }
              
              // 播放抽奖音效
              playSound('draw');
              
              const drawPlaceholder = document.getElementById('drawPlaceholder');
              
              // 隐藏提示文案
              if (drawPlaceholder) {
                  drawPlaceholder.style.display = 'none';
              }
              
              drawCards.innerHTML = ''; // 清空现有卡片
              
              try {
                  // 调用真实抽奖API
                  const response = await fetch(`${API_BASE_URL}/draw/`, {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify({
                          user_id: currentUser.user_id,
                          draw_type: times
                      })
                  });

                  const data = await response.json();
                  
                  if (response.ok) {
                                           // 更新用户金币
                     if (data.data && data.data.remaining_coins !== undefined) {
                         currentUser.coins = data.data.remaining_coins;
                         updateDrawQualification();
                     }
                      
                      // 显示抽奖结果
                      if (data.data && data.data.draw_results) {
                          showDrawResults(data.data.draw_results, drawCards);
                      } else {
                          // 如果API没有返回结果，使用备用方案
                          showBackupDrawResults(times, drawCards);
                      }
                  } else {
                      // 特别处理金币不足的情况
                      if (data.message && data.message.includes('金币不足')) {
                          const costCoins = times === 1 ? 20 : 90;
                          const currentCoins = currentUser.coins || 0;
                          const needed = costCoins - currentCoins;
                          showToast(`金币不足，无法抽奖\n需要${costCoins}金币，当前${currentCoins}金币\n还差${needed}金币`, 'error');
                          
                          // 金币不足时，在drawCards区域显示如何获取金币的文案
                          drawCards.innerHTML = `
                              <div class="insufficient-coins-content">
                                  <div class="coins-title">如何获取金币</div>
                                  <div class="coins-text">参与游戏，通过游戏对战获得金币</div>
                              </div>
                          `;
                          // 移除loading状态
                          drawCards.classList.remove('loading');
                          return; // 直接返回，不执行后续的备用方案
                      } else {
                          showToast(data.message || '抽奖失败', 'error');
                          // 其他错误时使用备用方案
                          showBackupDrawResults(times, drawCards);
                      }
                  }
              } catch (error) {
                  console.error('抽奖API错误:', error);
                  showToast('网络错误，请重试', 'error');
                  
                  // 网络错误时，恢复提示文案显示，不展示任何卡片
                  if (drawPlaceholder) {
                      drawPlaceholder.style.display = 'block';
                  }
              } finally {
                  // 移除loading状态
                  drawCards.classList.remove('loading');
              }
          }
          
          // 显示抽奖结果
          function showDrawResults(prizes, container) {
              prizes.forEach((prize, index) => {
                  setTimeout(() => {
                      const card = document.createElement('div');
                      card.className = 'draw-card';
                      
                      card.innerHTML = `
                          <div class="draw-card-front">?</div>
                          <div class="draw-card-back">${prize.prize_name || prize}</div>
                      `;
                      container.appendChild(card);
                      
                      // 延迟翻转卡片 - 确保至少等待1秒再翻转
                      setTimeout(() => {
                          card.classList.add('flipped');
                          
                          // 播放翻转音效
                          playSound('flip');
                          
                          // 翻转后再添加金色边框样式（如果是好奖品）
                          if (prize.prize_type <= 3) {
                              card.classList.add('golden-prize');
                              // 播放中奖音效
                              playSound('win');
                          }
                      }, 1000 + index * 500);
                  }, index * 200);
              });
          }
          
          // 备用抽奖结果（当API不可用时）
          function showBackupDrawResults(times, container) {
              const cards = [];
              for (let i = 0; i < times; i++) {
                  const card = document.createElement('div');
                  card.className = 'draw-card';
                  
                  card.innerHTML = `
                      <div class="draw-card-front">?</div>
                      <div class="draw-card-back">${getRandomPrize()}</div>
                  `;
                  container.appendChild(card);
                  cards.push(card);
              }
              
              // 延迟翻转卡片 - 确保至少等待1秒再翻转
              setTimeout(() => {
                  cards.forEach((card, index) => {
                      setTimeout(() => {
                          card.classList.add('flipped');
                          
                          // 播放翻转音效
                          playSound('flip');
                          
                          // 翻转后再随机添加金色边框（模拟好奖品）
                          if (Math.random() > 0.7) { // 30%概率获得金色边框
                              card.classList.add('golden-prize');
                              // 播放中奖音效
                              playSound('win');
                          }
                      }, 1000 + index * 500);
                  });
              }, 1000);
          }

                   // 获取随机奖品
         function getRandomPrize() {
             return prizes[Math.floor(Math.random() * prizes.length)];
         }
         
         // 获取用户默认地址
         async function getUserDefaultAddress() {
             try {
                 const response = await fetch(`${API_BASE_URL}/user-address/`, {
                     method: 'GET',
                     headers: {
                       'Content-Type': 'application/json',
                       'Accept': 'application/json',
                     }
                 });
                 
                 if (response.ok) {
                     const data = await response.json();
                     if (data.data && data.data.length > 0) {
                         // 优先返回默认地址，如果没有默认地址则返回第一个地址
                         const defaultAddress = data.data.find(addr => addr.is_default) || data.data[0];
                         return defaultAddress;
                     }
                 }
                 return null;
             } catch (error) {
                 console.error('获取用户地址失败:', error);
                 return null;
             }
         }
         
                   // 验证处理函数
          async function handleVerification() {
              const code = document.getElementById('verificationCode').value.trim();
              if (!code) {
                  showToast('请输入验证码', 'error');
                  return;
              }
              
              try {
                  const success = await verifyUser(code);
                  if (success) {
                      // 验证成功后保存状态并更新显示
                      saveVerificationState();
                      updateDrawCardsDisplay();
                      updateDrawQualification();
                  }
              } catch (error) {
                  console.error('验证失败:', error);
              }
          }
          
                                           // 更新抽奖卡片区域显示
            function updateDrawCardsDisplay() {
                const drawPlaceholder = document.getElementById('drawPlaceholder');
                const drawButtons = document.getElementById('drawButtons');
                const verificationSection = document.querySelector('.verification-section');
                const drawOptionsSection = document.querySelector('.draw-options-section');
                
                if (isVerified && currentUser) {
                    // 验证成功，显示抽奖提示并显示抽奖按钮
                    drawPlaceholder.innerHTML = `
                        <div class="placeholder-icon">🎯</div>
                        <div class="placeholder-text">点击下方按钮开始抽奖</div>
                        <div class="placeholder-subtext">选择抽奖次数，赢取丰厚奖品</div>

                    `;
                    // 显示抽奖按钮区域
                    if (drawButtons) {
                        drawButtons.style.display = 'flex';
                    }
                    // 隐藏验证区域，显示抽奖选项区域
                    if (verificationSection) {
                        verificationSection.style.display = 'none';
                    }
                    if (drawOptionsSection) {
                        drawOptionsSection.style.display = 'flex';
                    }
                } else {
                    // 未验证，显示验证表单
                    drawPlaceholder.innerHTML = `
                        <div class="placeholder-icon">🔐</div>
                        <div class="placeholder-text">请输入验证码</div>
                       
                    `;
                    // 显示验证区域，隐藏抽奖选项区域
                    if (drawButtons) {
                        drawButtons.style.display = 'flex';
                    }
                    if (verificationSection) {
                        verificationSection.style.display = 'flex';
                    }
                    if (drawOptionsSection) {
                        drawOptionsSection.style.display = 'none';
                    }
                }
             }
            
                         // 处理回车键
             function handleKeyPress(event) {
                 if (event.key === 'Enter') {
                     handleVerification();
                 }
             }
             
             // 限制输入框长度和字符类型
             function limitInput(input) {
                 // 只允许数字
                //  input.value = input.value.replace(/[^0-9]/g, '');
                 
                 // 限制最大长度为8位
                 if (input.value.length > 8) {
                     input.value = input.value.slice(0, 8);
                 }
             }
          
          // 用户验证功能
          async function verifyUser(code) {
             try {
                 const response = await fetch(`${API_BASE_URL}/verify/`, {
                     method: 'POST',
                     headers: {
                         'Content-Type': 'application/json',
                     },
                                           body: JSON.stringify({
                          password: code
                      })
                 });

                 const data = await response.json();
                 
                 if (response.ok) {
                     currentUser = data.data;
                     isVerified = true;
                     
                     // 保存验证状态
                     saveVerificationState();
                     
                     // 更新页面显示
                     updateDrawQualification();
                     updateDrawCardsDisplay();
                     
                     // 显示订单模块并加载用户订单
                     const ordersSection = document.querySelector('.orders-section');
                     if (ordersSection) {
                         ordersSection.style.display = 'block';
                     }
                     loadUserOrders();
                     
                     showToast('验证成功！', 'success');
                     return true;
                 } else {
                     showToast(data.message || '验证失败', 'error');
                     return false;
                 }
             } catch (error) {
                 console.error('验证API错误:', error);
                 showToast('网络错误，请重试', 'error');
                 return false;
             }
         }
         
         // 更新抽奖资格显示
         function updateDrawQualification() {
             const qualificationElement = document.getElementById('drawQualification');
             if (currentUser && isVerified) {
                 qualificationElement.textContent = `${currentUser.name || 0}，您当前拥有 ${currentUser.coins || 0} 金币`;
             } else {
                 qualificationElement.textContent = '关注微信公众号，回复【账号】获得验证码';
             }
         }
         
                             // Toast提示功能
          function showToast(message, type = 'info') {
              // 创建toast元素
              const toast = document.createElement('div');
              toast.style.cssText = `
                  position: fixed;
                  top: 20px;
                  right: -320px;
                  background: ${type === 'error' ? '#ff4757' : type === 'success' ? '#2ed573' : '#3742fa'};
                  color: white;
                  padding: 16px 24px;
                  border-radius: 12px;
                  z-index: 10000;
                  font-size: 16px;
                  font-weight: bold;
                  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
                  backdrop-filter: blur(10px);
                  border: 2px solid rgba(255, 255, 255, 0.2);
                  min-width: 200px;
                  max-width: 300px;
                  text-align: center;
                  transition: right 0.4s ease;
              `;
              toast.textContent = message;
              
              document.body.appendChild(toast);
              
              // 从右到左滑入
              setTimeout(() => {
                  toast.style.right = '20px';
              }, 100);
              
              // 2秒后直接消失
              setTimeout(() => {
                  if (toast.parentNode) {
                      toast.parentNode.removeChild(toast);
                  }
              }, 2000);
          }



        // 我的奖励按钮点击事件
        document.querySelector('.rewards-btn').addEventListener('click', function() {
            // 检查用户是否已验证
            if (!isVerified || !currentUser) {
                showToast('请先验证身份', 'error');
                return;
            }
            
            // 显示盲盒订单弹窗
            showOrdersModal();
        });

                                                                       // 去购物按钮点击事件
           document.querySelector('.shopping-btn').addEventListener('click', function() {
               // 检查用户是否已验证
               if (!isVerified || !currentUser) {
                   showToast('请先验证身份', 'error');
                   return;
               }
               
                              // 检查用户金币是否足够（盲盒价格2000金币）
                if (!currentUser.coins || currentUser.coins < 2000) {
                    const needed = 2000 - (currentUser.coins || 0);
                    showToast(`金币不足，无法兑换盲盒\n需要2000金币，当前${currentUser.coins || 0}金币\n还差${needed}金币`, 'error');
                    return;
                }
               
               // 先查询用户地址，然后显示地址管理弹窗
               loadUserAddresses();
           });
          
                     // 创建盲盒订单 - 参考lottery.html的统一下单逻辑
           async function createBlindBoxOrder() {
               try {
                   // 显示加载提示
                   showToast('正在创建盲盒订单...', 'info');
                   
                   // 获取用户选中的地址
                   const selectedAddress = getSelectedAddress();
                   if (!selectedAddress) {
                       showToast('请先添加收货地址', 'error');
                       return;
                   }
                   
                   // 准备请求数据 - 使用固定的item_id，参考lottery.html逻辑
                   const requestData = {
                       user_id: currentUser.user_id,
                       item_id: '5c1563fa-e38f-43c4-b7ad-aaaed0458304',  // 固定盲盒商品ID
                       contact_info: {
                           name: selectedAddress.name,
                           phone: selectedAddress.phone,
                           address: selectedAddress.address
                       }
                   };
                   
                   console.log('盲盒订单请求数据:', requestData);
                   console.log('请求URL:', `${API_BASE_URL.replace('/lottery', '/shop')}/exchange/`);
                   
                   // 调用统一的商品兑换API - 参考lottery.html的API调用方式
                   const response = await fetch(`${API_BASE_URL.replace('/lottery', '/shop')}/exchange/`, {
                       method: 'POST',
                       headers: {
                           'Content-Type': 'application/json',
                       },
                       body: JSON.stringify(requestData)
                   });

                   console.log('响应状态:', response.status);
                   const data = await response.json();
                   console.log('响应数据:', data);
                   
                   if (response.ok) {
                       // 更新用户金币 - 参考lottery.html的金币更新逻辑
                       if (data.data && data.data.remaining_coins !== undefined) {
                           currentUser.coins = data.data.remaining_coins;
                           updateDrawQualification();
                           
                           // 更新缓存数据
                           const cachedUserData = localStorage.getItem('cachedUserData');
                           if (cachedUserData) {
                               const cachedUser = JSON.parse(cachedUserData);
                               cachedUser.coins = currentUser.coins;
                               localStorage.setItem('cachedUserData', JSON.stringify(cachedUser));
                           }
                       }
                       
                       // 显示成功信息 - 参考lottery.html的成功反馈
                       const orderInfo = data.data;
                       showToast(`盲盒订单创建成功！\n订单号：${orderInfo.order_id}`, 'success');
                       
                       // 刷新订单列表
                       loadUserOrders();
                       
                       // 显示详细订单信息 - 参考lottery.html的订单详情展示
                       setTimeout(() => {
                           showOrderDetails(orderInfo, requestData.contact_info);
                       }, 1000);
                       
                   } else {
                       console.error('API错误响应:', data);
                       showToast(data.message || `盲盒订单创建失败 (${response.status})`, 'error');
                   }
               } catch (error) {
                   console.error('盲盒订单API错误:', error);
                   showToast(`网络错误: ${error.message}`, 'error');
               }
           }

           // 显示订单详情 - 参考lottery.html的订单详情展示
           function showOrderDetails(orderData, contactInfo) {
               const orderHtml = `
                   <div style="background: rgba(0,0,0,0.9); position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; display: flex; align-items: center; justify-content: center;">
                       <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);">
                           <h3 style="color: #ffd700; text-align: center; margin-bottom: 20px;">🎉 盲盒订单创建成功</h3>
                           <div style="color: #fff; line-height: 1.6;">
                               <p><strong>商品名称：</strong>${orderData.item_name}</p>
                               <p><strong>订单号：</strong>${orderData.order_id}</p>
                               <p><strong>兑换价格：</strong>${orderData.price} 🪙</p>
                               <p><strong>剩余金币：</strong>${orderData.remaining_coins} 🪙</p>
                               <p><strong>收货人：</strong>${contactInfo.name}</p>
                               <p><strong>联系电话：</strong>${contactInfo.phone}</p>
                               <p><strong>收货地址：</strong>${contactInfo.address}</p>
                               <p><strong>兑换时间：</strong>${new Date(orderData.exchange_time).toLocaleString()}</p>
                               <p><strong>订单状态：</strong><span style="color: #ffc107;">待发货</span></p>
                           </div>
                           <div style="text-align: center; margin-top: 20px;">
                               <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">确定</button>
                           </div>
                       </div>
                   </div>
               `;
               document.body.insertAdjacentHTML('beforeend', orderHtml);
           }

                 // 奖品点击事件 - 已注释，因为奖品网格不存在
         // document.querySelectorAll('.prize-item').forEach(item => {
         //     item.addEventListener('click', function() {
         //         const prizeName = this.querySelector('.prize-name').textContent;
         //         alert(`奖品详情：${prizeName}`);
         //     });
         // });

                   // 动态生成用户信息数据（定时更新文案）
          let userInfoUpdateTimer = null;
          
          function generateUserInfoData() {
              const container = document.getElementById('userInfoContainer');
              
              // 生成脱敏用户名
              const generateDesensitizedName = () => {
                  const prefixes = ['用户', '玩家', '幸运儿', '抽奖者', '小伙伴', '朋友', '用户', '玩家'];
                  const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
                  const suffix = Math.floor(Math.random() * 999) + 1;
                  return `${prefix}***${suffix}`;
              };
              
              // 生成金币数量（简化为指定的金币数量）
              const generateCoinAmount = () => {
                  const amounts = [5, 10, 20, 50, 500, 2000];
                  return amounts[Math.floor(Math.random() * amounts.length)];
              };
              
              // 简化的消息生成函数
              const generateRandomMessage = () => {
                  const userName = generateDesensitizedName();
                  const coinAmount = generateCoinAmount();
                  return `${userName}抽中${coinAmount}金币`;
              };
              
              // 更新文案内容
              const updateUserInfoMessage = () => {
                  const userStatusElement = container.querySelector('.user-status');
                  if (userStatusElement) {
                      const newMessage = generateRandomMessage();
                      userStatusElement.textContent = newMessage;
                      console.log('更新文案:', newMessage);
                  }
              };
              
              console.log('开始生成用户信息数据');
              
              // 清空现有内容
              container.innerHTML = '';
              
              // 生成1个用户信息项
              const initialMessage = generateRandomMessage();
              
              const userInfoItem = document.createElement('div');
              userInfoItem.className = 'user-info-item';
              userInfoItem.innerHTML = `
                  <div class="user-avatar">👤</div>
                  <div class="user-status">${initialMessage}</div>
              `;
              
              container.appendChild(userInfoItem);
              
              console.log('生成了1个用户信息项');
              
              // 直接显示，不需要切换动画
              if (userInfoItem) {
                  userInfoItem.classList.add('active');
              }
              
              // 启动定时更新（每3-5秒更新一次）
              if (userInfoUpdateTimer) {
                  clearInterval(userInfoUpdateTimer);
              }
              
              userInfoUpdateTimer = setInterval(() => {
                  updateUserInfoMessage();
              }, 3000 + Math.random() * 2000); // 3-5秒随机间隔
              
              console.log('启动定时更新文案功能');
          }

                     // 页面卸载时清理定时器
                     window.addEventListener('beforeunload', function() {
                         if (userInfoUpdateTimer) {
                             clearInterval(userInfoUpdateTimer);
                             console.log('清理用户信息更新定时器');
                         }
                     });
                     
                     // 页面加载时生成用户信息数据
                        window.addEventListener('load', async function() {
                 console.log('页面加载完成，开始初始化用户信息');
                 await loadVerificationState(); // 先加载验证状态
                 generateUserInfoData();
                 updateDrawQualification();
                 updateDrawCardsDisplay();
                 
                 // 加载用户订单
                 if (isVerified && currentUser) {
                     loadUserOrders();
                 }
             });
          
                      // 也尝试在DOMContentLoaded时执行
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOM加载完成，开始初始化用户信息');
                generateUserInfoData();
            });

            // 地址管理相关变量
            let userAddresses = [];
            let editingAddressId = null;
            let selectedAddressId = null; // 新增：选中的地址ID

            // 获取用户默认地址 - 参考lottery.html的地址获取逻辑
            async function getUserDefaultAddress() {
                try {
                    const response = await fetch(`${API_BASE_URL.replace('/lottery', '/shop')}/address/?user_id=${currentUser.user_id}`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    const data = await response.json();
                    
                    if (response.ok && data.data.addresses && data.data.addresses.length > 0) {
                        // 返回第一个地址作为默认地址
                        return data.data.addresses[0];
                    } else {
                        return null;
                    }
                } catch (error) {
                    console.error('获取用户地址失败:', error);
                    return null;
                }
            }

            // 获取选中的地址
            function getSelectedAddress() {
                if (!selectedAddressId) {
                    // 如果没有选中地址，返回默认地址（第一个地址）
                    return userAddresses.length > 0 ? userAddresses[0] : null;
                }
                return userAddresses.find(addr => addr.id === selectedAddressId) || userAddresses[0];
            }

            // 选择地址
            function selectAddress(addressId) {
                selectedAddressId = addressId;
                // 更新地址列表的选中状态
                renderAddressList();
            }

            // 加载用户地址
            async function loadUserAddresses() {
                try {
                    showToast('正在加载地址信息...', 'info');
                    
                    const response = await fetch(`${API_BASE_URL.replace('/lottery', '/shop')}/address/?user_id=${currentUser.user_id}`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        userAddresses = data.data.addresses || [];
                        // 设置默认选中地址（第一个地址或默认地址）
                        if (userAddresses.length > 0) {
                            const defaultAddress = userAddresses.find(addr => addr.is_default) || userAddresses[0];
                            selectedAddressId = defaultAddress.id;
                        }
                        showAddressModal();
                    } else {
                        console.error('加载地址失败:', data);
                        showToast(data.message || '加载地址失败', 'error');
                        // 即使加载失败也显示弹窗，允许用户添加地址
                        userAddresses = [];
                        showAddressModal();
                    }
                } catch (error) {
                    console.error('地址API错误:', error);
                    showToast('网络错误，请重试', 'error');
                    // 即使网络错误也显示弹窗，允许用户添加地址
                    userAddresses = [];
                    showAddressModal();
                }
            }

            // 显示地址管理弹窗
            function showAddressModal() {
                const modal = document.getElementById('addressModal');
                modal.style.display = 'block';
                renderAddressList();
            }

            // 关闭地址管理弹窗
            function closeAddressModal() {
                const modal = document.getElementById('addressModal');
                modal.style.display = 'none';
                hideAddressForm();
            }

            // 显示盲盒订单弹窗
            function showOrdersModal() {
                const modal = document.getElementById('ordersModal');
                modal.style.display = 'block';
                
                loadModalOrders();
                
                // 添加滚动监听器
                const container = document.getElementById('modalOrdersContainer');
                if (container) {
                    container.addEventListener('scroll', handleModalScroll);
                }
            }

            // 关闭盲盒订单弹窗
            function closeOrdersModal() {
                const modal = document.getElementById('ordersModal');
                modal.style.display = 'none';
                
                // 移除滚动监听器
                const container = document.getElementById('modalOrdersContainer');
                if (container) {
                    container.removeEventListener('scroll', handleModalScroll);
                }
            }

            // 加载弹窗中的抽奖记录
            async function loadModalOrders(page = 1, append = false) {
                if (isLoadingRecords) return;
                
                try {
                    isLoadingRecords = true;
                    const loadingElement = document.getElementById('modalLoadingOrders');
                    const container = document.getElementById('modalOrdersContainer');
                    
                    if (page === 1 && container) {
                        // 重置状态
                        currentPage = 1;
                        hasMoreRecords = true;
                        container.innerHTML = '';
                    }
                    
                    // 显示加载状态
                    if (loadingElement) {
                        loadingElement.style.display = 'block';
                    }
                    
                    // 调用新的抽奖记录API
                    const response = await fetch(`${API_BASE_URL.replace('/lottery', '')}/lottery-draw-records/?user_id=${currentUser.user_id}&page=${page}&per_page=10`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    const data = await response.json();
                    
                    if (response.ok && data.code === 200 && data.data.records) {
                        // 显示用户的抽奖记录
                        renderModalRecords(data.data.records, append);
                        
                        // 更新分页状态
                        hasMoreRecords = data.data.has_next;
                        currentPage = page;
                    } else {
                        console.error('加载抽奖记录失败:', data);
                        if (page === 1) {
                            showToast('加载抽奖记录失败', 'error');
                            showNoModalOrders();
                        }
                    }
                } catch (error) {
                    console.error('抽奖记录API错误:', error);
                    if (page === 1) {
                        showToast('网络错误，请重试', 'error');
                        showNoModalOrders();
                    }
                } finally {
                    isLoadingRecords = false;
                    const loadingElement = document.getElementById('modalLoadingOrders');
                    if (loadingElement) {
                        loadingElement.style.display = 'none';
                    }
                    
                    // 移除订单弹窗loading状态
                    const ordersModal = document.getElementById('ordersModal');
                    if (ordersModal) {
                        ordersModal.classList.remove('loading');
                    }
                }
            }

            // 渲染弹窗中的抽奖记录列表
            function renderModalRecords(records, append = false) {
                const container = document.getElementById('modalOrdersContainer');
                const loadingElement = document.getElementById('modalLoadingOrders');
                
                // 隐藏加载状态
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                
                if (records.length === 0 && !append) {
                    showNoModalOrders();
                    return;
                }
                
                const recordsHTML = records.map(record => {
                    const statusText = record.is_special ? '特殊奖励' : '普通金币';
                    const statusClass = record.is_special ? 'special' : 'completed';
                    
                    // 根据奖品类型显示不同的图标
                    let icon = '🎁';
                    if (record.prize_type === 5) icon = '💰'; // 金币
                    else if (record.prize_type === 4) icon = '🎯'; // 四等奖
                    else if (record.prize_type === 3) icon = '🏆'; // 三等奖
                    else if (record.prize_type === 2) icon = '🥈'; // 二等奖
                    else if (record.prize_type === 1) icon = '🥇'; // 一等奖
                    
                    return `
                        <div class="lottery-record-item">
                            <div class="lottery-record-header">
                                <div class="lottery-record-info">
                                    <div class="lottery-record-icon">
                                        <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">${icon}</div>
                                    </div>
                                    <div class="lottery-record-details">
                                        ${record.earned_coins > 0 ? `<div class="detail-item">
                                            <strong>获得：</strong>${record.earned_coins}💰
                                        </div>` : ''}
                                    </div>
                                </div>
                                <div class="lottery-record-status ${statusClass}">${statusText}</div>
                            </div>
                            <div class="lottery-record-content">
                                <div class="detail-item">
                                    <strong>抽奖时间：</strong>${record.draw_time}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                if (container) {
                    if (append) {
                        container.innerHTML += recordsHTML;
                    } else {
                        container.innerHTML = recordsHTML;
                    }
                }
                
                // 如果没有更多数据，显示加载完成提示
                if (!hasMoreRecords && records.length > 0 && container) {
                    container.innerHTML += `
                        <div style="text-align: center; padding: 20px; color: #999; font-size: 0.9rem;">
                            已加载全部记录
                        </div>
                    `;
                }
            }
            
            // 获取奖品类型文本
            function getPrizeTypeText(prizeType) {
                switch(prizeType) {
                    case 1: return '一等奖';
                    case 2: return '二等奖';
                    case 3: return '三等奖';
                    case 4: return '四等奖';
                    case 5: return '五等奖';
                    default: return '未知类型';
                }
            }

            // 处理弹窗滚动事件
            function handleModalScroll(event) {
                const container = event.target;
                const scrollTop = container.scrollTop;
                const scrollHeight = container.scrollHeight;
                const clientHeight = container.clientHeight;
                
                // 当滚动到底部时加载更多数据
                if (scrollTop + clientHeight >= scrollHeight - 50 && hasMoreRecords && !isLoadingRecords) {
                    loadModalOrders(currentPage + 1, true);
                }
            }
            
            // 显示弹窗中无记录信息
            function showNoModalOrders() {
                const container = document.getElementById('modalOrdersContainer');
                const loadingElement = document.getElementById('modalLoadingOrders');
                
                // 隐藏加载状态
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                
                if (container) {
                    container.innerHTML = `
                        <div class="no-orders">
                            <div class="no-orders-icon">📋</div>
                            <div>暂无抽奖记录</div>
                            <div style="font-size: 0.9rem; margin-top: 10px; color: #999;">快去参与抽奖吧！</div>
                        </div>
                    `;
                }
            }

            // 渲染地址列表
            function renderAddressList() {
                const addressList = document.getElementById('addressList');
                
                if (userAddresses.length === 0) {
                    addressList.innerHTML = `
                        <div class="no-address">
                            <div class="no-address-icon">📍</div>
                            <div>暂无收货地址</div>
                            <div style="font-size: 0.9rem; margin-top: 10px; color: #999;">请添加收货地址以便兑换盲盒</div>
                        </div>
                    `;
                } else {
                    addressList.innerHTML = userAddresses.map(address => {
                        const isSelected = selectedAddressId === address.id || (!selectedAddressId && address.is_default);
                        return `
                            <div class="address-item ${address.is_default ? 'default' : ''} ${isSelected ? 'selected' : ''}" data-id="${address.id}" onclick="selectAddress('${address.id}')" style="cursor: pointer;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div class="address-name">${address.name}</div>
                                        <div class="address-phone">${address.phone}</div>
                                        <div class="address-detail">${address.address}</div>
                                    </div>
                                    <div style="color: #ffd700; font-size: 1.2rem;">
                                        ${isSelected ? '✓' : '○'}
                                    </div>
                                </div>
                                <div style="margin-top: 10px; display: flex; gap: 10px;">
                                    <button onclick="event.stopPropagation(); editAddress('${address.id}')" style="padding: 5px 10px; background: #f1f1f1; border: none; border-radius: 5px; font-size: 0.8rem; cursor: pointer;">编辑</button>
                                    <button onclick="event.stopPropagation(); deleteAddress('${address.id}')" style="padding: 5px 10px; background: #ff4757; color: white; border: none; border-radius: 5px; font-size: 0.8rem; cursor: pointer;">删除</button>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }

            // 显示地址表单
            function showAddressForm(addressId = null) {
                const form = document.getElementById('addressForm');
                const nameInput = document.getElementById('addressName');
                const phoneInput = document.getElementById('addressPhone');
                const detailInput = document.getElementById('addressDetail');
                const defaultCheckbox = document.getElementById('addressDefault');
                
                // 清空表单
                nameInput.value = '';
                phoneInput.value = '';
                detailInput.value = '';
                defaultCheckbox.checked = false;
                
                if (addressId) {
                    // 编辑模式
                    editingAddressId = addressId;
                    const address = userAddresses.find(addr => addr.id === addressId);
                    if (address) {
                        nameInput.value = address.name;
                        phoneInput.value = address.phone;
                        detailInput.value = address.address;
                        defaultCheckbox.checked = address.is_default;
                    }
                } else {
                    // 新增模式
                    editingAddressId = null;
                }
                
                form.style.display = 'block';
            }

            // 隐藏地址表单
            function hideAddressForm() {
                const form = document.getElementById('addressForm');
                form.style.display = 'none';
                editingAddressId = null;
            }

            // 保存地址
            async function saveAddress() {
                const nameInput = document.getElementById('addressName');
                const phoneInput = document.getElementById('addressPhone');
                const detailInput = document.getElementById('addressDetail');
                const defaultCheckbox = document.getElementById('addressDefault');
                
                const name = nameInput.value.trim();
                const phone = phoneInput.value.trim();
                const address = detailInput.value.trim();
                const isDefault = defaultCheckbox.checked;
                
                if (!name || !phone || !address) {
                    showToast('请填写完整的地址信息', 'error');
                    return;
                }
                
                // 验证手机号格式
                const phoneRegex = /^1[3-9]\d{9}$/;
                if (!phoneRegex.test(phone)) {
                    showToast('请输入正确的手机号码', 'error');
                    return;
                }
                
                try {
                    const requestData = {
                        user_id: currentUser.user_id,
                        name: name,
                        phone: phone,
                        address: address,
                        is_default: isDefault
                    };
                    
                    let url = `${API_BASE_URL.replace('/lottery', '/shop')}/address/`;
                    let method = 'POST';
                    
                    if (editingAddressId) {
                        // 编辑模式
                        url = `${API_BASE_URL.replace('/lottery', '/shop')}/address/`;
                        method = 'PUT';
                        requestData.id = editingAddressId;
                    }
                    
                    const response = await fetch(url, {
                        method: method,
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(requestData)
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        showToast(editingAddressId ? '地址更新成功' : '地址添加成功', 'success');
                        hideAddressForm();
                        // 重新加载地址列表
                        await loadUserAddresses();
                    } else {
                        showToast(data.message || '保存地址失败', 'error');
                    }
                } catch (error) {
                    console.error('保存地址API错误:', error);
                    showToast('网络错误，请重试', 'error');
                }
            }

            // 编辑地址
            function editAddress(addressId) {
                showAddressForm(addressId);
            }

            // 删除地址
            async function deleteAddress(addressId) {
                if (!confirm('确定要删除这个地址吗？')) {
                    return;
                }
                
                try {
                    const response = await fetch(`${API_BASE_URL.replace('/lottery', '/shop')}/address/?id=${addressId}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        showToast('地址删除成功', 'success');
                        // 重新加载地址列表
                        await loadUserAddresses();
                    } else {
                        showToast(data.message || '删除地址失败', 'error');
                    }
                } catch (error) {
                    console.error('删除地址API错误:', error);
                    showToast('网络错误，请重试', 'error');
                }
            }

                         // 取消地址编辑
             function cancelAddress() {
                 hideAddressForm();
             }

             // 确认兑换盲盒
             async function confirmBlindBoxOrder() {
                 // 检查是否有地址
                 if (userAddresses.length === 0) {
                     showToast('请先添加收货地址', 'error');
                     return;
                 }
                 
                 // 检查是否选择了地址
                 const selectedAddress = getSelectedAddress();
                 if (!selectedAddress) {
                     showToast('请选择一个收货地址', 'error');
                     return;
                 }
                 
                 try {
                     // 关闭弹窗
                     closeAddressModal();
                     
                     // 执行兑换逻辑
                     await createBlindBoxOrder();
                 } catch (error) {
                     console.error('确认订单失败:', error);
                 }
             }

             // 加载用户盲盒订单
             async function loadUserOrders() {
                 if (!currentUser || !currentUser.user_id) {
                     console.log('用户未验证，跳过加载订单');
                     return;
                 }

                 try {
                     console.log('正在加载用户盲盒订单...');
                     const response = await fetch(`${API_BASE_URL.replace('/lottery', '/shop')}/records/?user_id=${currentUser.user_id}`, {
                         method: 'GET',
                         headers: {
                             'Content-Type': 'application/json',
                         }
                     });

                     const data = await response.json();
                     
                     if (response.ok && data.code === 200) {
                         // 过滤出盲盒订单
                         const blindBoxOrders = data.data.records.filter(order => order.item_name && order.item_name.includes('盲盒'));
                         renderOrders(blindBoxOrders);
                     } else {
                         console.error('加载订单失败:', data);
                         showNoOrders();
                     }
                 } catch (error) {
                     console.error('加载订单API错误:', error);
                     showNoOrders();
                 }
             }

             // 渲染订单列表
             function renderOrders(orders) {
                 const container = document.getElementById('ordersContainer');
                 const loadingElement = document.getElementById('loadingOrders');
                 
                 // 隐藏加载状态
                 if (loadingElement) {
                     loadingElement.style.display = 'none';
                 }

                 if (!orders || orders.length === 0) {
                     showNoOrders();
                     return;
                 }

                 const ordersHTML = orders.map(order => `
                     <div class="blind-box-order-item">
                         <div class="blind-box-order-header">
                             <div class="blind-box-order-info">
                                 <div class="blind-box-order-icon">
                                     <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">📦</div>
                                 </div>
                                 <div class="blind-box-order-details">
                                     <h4>${order.item_name} ${order.order_id}</h4>
                                     <div style="color: #ffd700; font-size: 0.9rem;">${order.exchange_time}</div>
                                 </div>
                             </div>
                             <div class="blind-box-order-status ${order.status}">${getStatusText(order.status)}</div>
                         </div>
                         <div class="blind-box-order-content">
                             <div class="blind-box-order-details-grid">
                                 
                                 <div class="detail-item">
                                     <strong>联系人：</strong>${order.contact_name}
                                 </div>
                                 <div class="detail-item">
                                     <strong>联系电话：</strong>${order.contact_phone}
                                 </div>
                                 <div class="detail-item">
                                     <strong>收货地址：</strong>${order.contact_address}
                                 </div>
                             </div>
                         </div>
                     </div>
                 `).join('');

                 container.innerHTML = ordersHTML;
             }

             // 显示无订单状态
             function showNoOrders() {
                 const container = document.getElementById('ordersContainer');
                 const loadingElement = document.getElementById('loadingOrders');
                 
                 if (loadingElement) {
                     loadingElement.style.display = 'none';
                 }

                 container.innerHTML = `
                     <div class="no-orders">
                         <div class="no-orders-icon">📦</div>
                         <div>暂无盲盒订单</div>
                         <div style="font-size: 0.9rem; margin-top: 10px; color: #999;">兑换盲盒后订单将显示在这里</div>
                     </div>
                 `;
             }

             // 获取订单状态文本
             function getStatusText(status) {
                 const statusMap = {
                     'pending': '待发货',
                     'shipped': '已发货',
                     'delivered': '已送达'
                 };
                 return statusMap[status] || status;
             }

                        // 盲盒商品数据
           const blindBoxProducts = [
               {
                   id: 1,
                   image: 'https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/04157b5c-c1f8-4b2a-8d7c-b644fdf509eb/1.jpg',
                   description: '神秘盲盒\n内含惊喜好礼'
               },
               {
                   id: 2,
                   image: 'https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/d81dce78-e636-4ada-a6df-d758bae1aa30/2.jpg',
                   description: '游戏周边\n精美手办模型'
               },
               {
                   id: 3,
                   image: 'https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/1b95d0e8-1b95-4732-8ed1-355c7ba04590/3.jpg',
                   description: '【金色传说】\n新款铁道原神斗破'
               },
               {
                   id: 4,
                   image: 'https://cdnwukong.com/5432f62d-b3f0-4e02-8bf9-efd70b29e730/cfe1ee97-6b9c-4abb-bb42-adbeaca27f3f/gzh.png',
                   description: '公众号\n回复订单号获取物流信息'
               }
           ];

             // 渲染盲盒商品
             function renderBlindBoxProducts() {
                 const container = document.getElementById('blindBoxProductsGrid');
                 
                 if (!container) {
                     console.log('盲盒商品容器未找到');
                     return;
                 }

                                const productsHTML = blindBoxProducts.map(product => `
                   <div class="blind-box-product-item" onclick="handleBlindBoxProductClick(${product.id})">
                       <div class="blind-box-product-image">
                           <img src="${product.image}" alt="盲盒商品" onerror="this.style.display='none'">
                       </div>
                       <div class="blind-box-product-description">${product.description}</div>
                   </div>
               `).join('');

                 container.innerHTML = productsHTML;
             }

             // 处理盲盒商品点击
             function handleBlindBoxProductClick(productId) {
                 console.log('点击了盲盒商品:', productId);
                 showToast('盲盒商品暂不支持自选...', 'info');
             }

             // 页面加载时初始化盲盒商品
             window.addEventListener('load', function() {
                 // 检测设备类型
                 checkDeviceType();
                 
                 // 初始化音效
                 initSounds();
                 
                 // 恢复音效设置
                 const savedSoundEnabled = localStorage.getItem('soundEnabled');
                 if (savedSoundEnabled !== null) {
                     soundEnabled = savedSoundEnabled === 'true';
                     const soundControl = document.getElementById('soundControl');
                     if (soundControl) {
                         if (soundEnabled) {
                             soundControl.textContent = '🔊';
                             soundControl.classList.remove('muted');
                         } else {
                             soundControl.textContent = '🔇';
                             soundControl.classList.add('muted');
                         }
                     }
                 }
                 
                 renderBlindBoxProducts();
             });
             
             // 检测设备类型并显示相应内容
             function checkDeviceType() {
                 const isMobile = window.innerWidth < 768;
                 const pcTip = document.getElementById('pcTip');
                 const mobileContainer = document.getElementById('mobileContainer');
                 
                 if (!isMobile) {
                     // PC端显示提示页面
                     pcTip.style.display = 'flex';
                     mobileContainer.style.display = 'none';
                 } else {
                     // 移动端显示正常内容
                     pcTip.style.display = 'none';
                     mobileContainer.style.display = 'block';
                 }
             }
             
             // 处理键盘调起时的视口调整
             function handleKeyboardAdjustment() {
                 const isKeyboardOpen = window.innerHeight < window.outerHeight * 0.7;
                 const body = document.body;
                 const gameMachine = document.querySelector('.game-machine');
                 
                 if (isKeyboardOpen) {
                     // 键盘调起时，保持原始视口设置，只添加样式类
                     body.classList.add('keyboard-open');
                     
                     // 确保游戏机背景图片保持比例
                     if (gameMachine) {
                         gameMachine.style.minHeight = '350px';
                     }
                     
                     // 滚动到输入框位置
                     const activeInput = document.querySelector('input:focus, textarea:focus');
                     if (activeInput) {
                         setTimeout(() => {
                             activeInput.scrollIntoView({ 
                                 behavior: 'smooth', 
                                 block: 'center' 
                             });
                         }, 100);
                     }
                 } else {
                     // 键盘收起时，移除样式类
                     body.classList.remove('keyboard-open');
                     
                     // 恢复游戏机背景图片设置
                     if (gameMachine) {
                         gameMachine.style.minHeight = '600px';
                     }
                 }
             }
             
             // 监听窗口大小变化
             window.addEventListener('resize', handleKeyboardAdjustment);
             
             // 监听输入框焦点事件
             document.addEventListener('focusin', function(e) {
                 if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                     // 输入框获得焦点时，延迟处理键盘调起
                     setTimeout(handleKeyboardAdjustment, 300);
                 }
             });
             
             document.addEventListener('focusout', function(e) {
                 if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                     // 输入框失去焦点时，延迟处理键盘收起
                     setTimeout(handleKeyboardAdjustment, 300);
                 }
             });
             
             // 显示移动端内容（用户点击"我知道了"后）
             function showMobileContent() {
                 const pcTip = document.getElementById('pcTip');
                 const mobileContainer = document.getElementById('mobileContainer');
                 
                 pcTip.style.display = 'none';
                 mobileContainer.style.display = 'block';
             }

    </script>
    </div><!-- 移动端容器结束 -->
</body>
</html> 
